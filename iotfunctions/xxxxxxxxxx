2024-10-02 05:58:04 PM [PID 1] [INFO   ] analytics_service.main.<module> : {'tenant_id': 'main18', 'entity_type_id': '912', 'start_ts': None, 'end_ts': None, 'entities': [], 'log_level': 'debug', 'log_keep_days': 90} 
2024-10-02 05:58:04 PM [PID 1] [INFO   ] analytics_service.main.<module> : file name db => /var/www/as-pipeline/db2_certificate.pem 
2024-10-02 05:58:04 PM [PID 1] [INFO   ] analytics_service.main.<module> : file name ca => /var/www/as-pipeline/ca_public_cert.pem 
2024-10-02 05:58:04 PM [PID 1] [INFO   ] analytics_service.api.__init__ : launch_date = 2024-10-02 17:58:04 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] iotfunctions.db.__init__ : Unable to locate message_hub credentials. Database object created, but it will not be able interact with message hub. 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] iotfunctions.db.__init__ : Found database type in os variable DB_TYPE: DB2 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] iotfunctions.db.__init__ : created a CosClient object 
2024-10-02 05:58:04 PM [PID 1] [INFO   ] iotfunctions.db.__init__ : Establishing database connection via SqlAlchemy. 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] iotfunctions.db.__init__ : Set isolation 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] iotfunctions.db.__init__ : Isolation level set 
2024-10-02 05:58:04 PM [PID 1] [INFO   ] iotfunctions.db.__init__ : Database connection via SqlAlchemy established. 
2024-10-02 05:58:04 PM [PID 1] [INFO   ] iotfunctions.db.__init__ : Establishing native database connection. 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] iotfunctions.db.connect_to_db2 : DB2 connection was established at attempt #1. 
2024-10-02 05:58:04 PM [PID 1] [INFO   ] iotfunctions.db.__init__ : Native database connection to DB2 established. 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] iotfunctions.db.http_request : URL: https://rest-dscmanager.mas-montest18-monitor.svc:9443/api/meta/v1/main18/entityType 
2024-10-02 05:58:04 PM [PID 1] [DEBUG  ] urllib3.connectionpool._new_conn : Starting new HTTPS connection (1): rest-dscmanager.mas-montest18-monitor.svc:9443 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] urllib3.connectionpool._make_request : https://rest-dscmanager.mas-montest18-monitor.svc:9443 "GET /api/meta/v1/main18/entityType HTTP/1.1" 200 None 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] iotfunctions.db.http_request : payload: b'{}' 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] iotfunctions.db.http_request : http request https://rest-dscmanager.mas-montest18-monitor.svc:9443/api/meta/v1/main18/entityType successful. status 200 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] iotfunctions.dbtables._store_table_exists : Table "MAIN18_MAM"."KPI_MODEL_STORE" exists. 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] MAS_Data_Dictionary.KITT.login_usr : login_usr(): Login using jwt authentication 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] urllib3.connectionpool._new_conn : Starting new HTTPS connection (1): kitt-v3-router.mas-montest18-add.svc:8080 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] urllib3.connectionpool._make_request : https://kitt-v3-router.mas-montest18-add.svc:8080 "POST /api/v3/user/login HTTP/1.1" 200 288 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] MAS_Data_Dictionary.KITT.__login_jwt : Retrieved new token 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] urllib3.connectionpool._new_conn : Starting new HTTPS connection (1): kitt-v3-router.mas-montest18-add.svc:8080 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] urllib3.connectionpool._make_request : https://kitt-v3-router.mas-montest18-add.svc:8080 "GET /api/v3/status HTTP/1.1" 200 73848 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] iotfunctions.db.__init__ : Connection to Data Dictionary has been established successfully: Retry count=0 url='https://kitt-v3-router.mas-montest18-add.svc:8080', tenant_id='main18' 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.util.api_request : api_request_url=https://rest-v2-core-api.mas-montest18-monitor.svc:9443/api/v2/core/pipeline/0891cab6-78b2-46db-9e48-655ac7021e1b/input 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] urllib3.connectionpool._new_conn : Starting new HTTPS connection (1): rest-v2-core-api.mas-montest18-monitor.svc:9443 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] urllib3.connectionpool._make_request : https://rest-v2-core-api.mas-montest18-monitor.svc:9443 "GET /api/v2/core/pipeline/0891cab6-78b2-46db-9e48-655ac7021e1b/input HTTP/1.1" 200 None 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._init_service : entity_type_name= {{ Industrial_boiler }} , entity_type_id= {{ 912 }} 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._init_service : entity_id_name= {{ id }}, entity_id_column= {{ deviceid }} 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._init_service : timestamp_name= {{ evt_timestamp }}, timestamp_column= {{ EVT_TIMESTAMP }} 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._init_service : dimension_data_items=['evt_timestamp_dim', 'firmware', 'manufacturer'], raw_data_items=['ENTITY_ID', 'air_flow_rate', 'company_code', 'deviceid', 'devicetype', 'eventtype', 'evt_timestamp', 'evt_timestamp_dim', 'firmware', 'format', 'fuel_flow_rate', 'input_flow_rate', 'logicalinterface_id', 'manufacturer', 'pressure', 'temp_set_point', 'updated_utc'], derived_data_items=['A_temp_anomaly', 'air_flow_rate_Industrial_boiler_mean', 'demo_output_metric', 'discharge_flow_rate', 'discharge_perc', 'entity_data_generator', 'output_flow_rate', 'output_flow_rate_Industrial_boiler_mean', 'p_leak', 'pressure_Industrial_boiler_mean', 'temperature'] 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._init_service : frequencies=['Daily', 'Hourly', 'Minute', 'Monthly', 'Weekly'] 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._init_service : granularities=[('Industrial_boiler', ('T', (), True, 3618))] 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._set_pipeline : kpi_declarations_filtered(enabled)=[{'kpiFunctionId': 933, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '1b38550f-84a4-4f56-b5e0-8c6b14b66bb0', 'description': 'An unsupervised anomaly detection function.\n     Applies a spectral analysis clustering techniqueto extract features from time series data and to create z scores.\n     Moves a sliding window across the data signal and applies the anomalymodelto each window.\n     The window size is typically set to 12 data points.\n     Try several anomaly detectors on your data and use the one that fits your data best.', 'catalogFunctionName': 'SpectralAnomalyScore', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'A_temp_anomaly'}, 'outputMeta': {'A_temp_anomaly': {'transient': False}}, 'input': {'input_item': 'temperature', 'windowsize': 12}, 'inputMeta': None, 'scope': None, 'schedule': {}, 'backtrack': {}, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'SpectralAnomalyScore', 'status': 'ACTIVE', 'description': 'An unsupervised anomaly detection function.\n     Applies a spectral analysis clustering techniqueto extract features from time series data and to create z scores.\n     Moves a sliding window across the data signal and applies the anomalymodelto each window.\n     The window size is typically set to 12 data points.\n     Try several anomaly detectors on your data and use the one that fits your data best.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.anomaly.SpectralAnomalyScore', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Anomaly score (zScore)', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'windowsize', 'description': 'Window size for spectral analysis - default 12', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}, {'name': 'input_item', 'description': 'Column for feature extraction', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': 'git+https://github.com/ibm-watson-iot/functions@extend_univariate', 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 931, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '15145ab5-d91d-4235-850c-f9625b111aab', 'description': 'Calculates the mean of the values in your data set.', 'catalogFunctionName': 'Mean', 'enabled': True, 'execStatus': False, 'granularityName': 'Industrial_boiler', 'output': {'name': 'air_flow_rate_Industrial_boiler_mean'}, 'outputMeta': None, 'input': {'source': 'air_flow_rate'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': 3618, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'Mean', 'status': 'ACTIVE', 'description': 'Calculates the mean of the values in your data set.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.aggregate.Mean', 'category': 'AGGREGATOR', 'output': [{'name': 'name', 'description': 'Enter a name for the data item that is produced as a result of this calculation.', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'source', 'description': 'Select the data item that you want to use as input for your calculation.', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 929, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'f9e04da2-813b-4e4a-bc79-e49b63d059d4', 'description': "\n    Execute a paste-in function. A paste-in function is python function declaration\n    code block. The function must be called 'f' and accept two inputs:\n    df (a pandas DataFrame) and parameters (a dict that you can use\n    to externalize the configuration of the function).\n\n    The function can return a DataFrame,Series,NumpyArray or scalar value.\n\n    Example:\n    def f(df,parameters):\n        #  generate an 2-D array of random numbers\n        output = np.random.normal(1,0.1,len(df.index))\n        return output\n\n    Function source may be pasted in or retrieved from Cloud Object Storage.\n\n    PythonFunction is currently experimental.\n    ", 'catalogFunctionName': 'PythonFunction', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'demo_output_metric'}, 'outputMeta': {'demo_output_metric': {'dataType': 'NUMBER', 'transient': False}}, 'input': {'function_code': "def f(df, parameters):\n    \n    output =df['air_flow_rate'] + ( df['pressure'] - 400. )\n    return output", 'input_items': ['air_flow_rate', 'pressure']}, 'inputMeta': None, 'scope': None, 'schedule': {'every': '5T', 'starting_at': '00:00:00'}, 'backtrack': {'days': 2}, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'PythonFunction', 'status': 'ACTIVE', 'description': "\n    Execute a paste-in function. A paste-in function is python function declaration\n    code block. The function must be called 'f' and accept two inputs:\n    df (a pandas DataFrame) and parameters (a dict that you can use\n    to externalize the configuration of the function).\n\n    The function can return a DataFrame,Series,NumpyArray or scalar value.\n\n    Example:\n    def f(df,parameters):\n        #  generate an 2-D array of random numbers\n        output = np.random.normal(1,0.1,len(df.index))\n        return output\n\n    Function source may be pasted in or retrieved from Cloud Object Storage.\n\n    PythonFunction is currently experimental.\n    ", 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.PythonFunction', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Choose an item name for the function output', 'learnMore': None, 'type': None, 'dataType': None, 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'parameters', 'description': 'optional parameters specified in json format', 'learnMore': None, 'type': 'CONSTANT', 'required': False, 'dataType': 'JSON', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}, {'name': 'input_items', 'description': 'Choose one or more data item to use as a function input', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'minItems': 1.0, 'items': {'type': 'string'}}, 'defaultValue': None, 'tags': []}, {'name': 'function_code', 'description': 'Paste in your function definition', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'LITERAL', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': ['TEXT']}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 926, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'e363d78e-48f0-432e-93f1-f694a137cb4d', 'description': '\n    Create a new item from an expression involving other items\n    ', 'catalogFunctionName': 'PythonExpression', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_name': 'discharge_flow_rate'}, 'outputMeta': None, 'input': {'expression': 'df["input_flow_rate"] * df["discharge_perc"]'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'PythonExpression', 'status': 'ACTIVE', 'description': '\n    Create a new item from an expression involving other items\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.PythonExpression', 'category': 'TRANSFORMER', 'output': [{'name': 'output_name', 'description': 'Output of expression', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'expression', 'description': "Define alert expression using pandas syntax. Example: df['inlet_temperature']>50", 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'LITERAL', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': ['TEXT', 'EXPRESSION']}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 925, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '52d38a2d-b3fd-4704-b58d-df083472001d', 'description': '\n    Generate a uniformally distributed random number.\n    ', 'catalogFunctionName': 'RandomUniform', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'discharge_perc'}, 'outputMeta': None, 'input': {'min_value': 0.1, 'max_value': 0.2}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'RandomUniform', 'status': 'ACTIVE', 'description': '\n    Generate a uniformally distributed random number.\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.RandomUniform', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Random output', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'min_value', 'description': 'Enter a constant value', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}, {'name': 'max_value', 'description': 'Enter a constant value', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 923, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '777d0069-d354-4a3a-97d9-1e2b58d387b8', 'description': '\n    Automatically load the entity input data table using new generated data.\n    Time series columns defined on the entity data table will be populated\n    with random data.\n\n    Optional parameters:\n\n    freq: pandas frequency string. Time series frequency.\n    scd_frequency: pandas frequency string.  Dimension change frequency.\n    activity_frequency: pandas frequency string. Activity frequency.\n    activities = dict keyed on activity name containing list of activities codes\n    scds = dict keyes on scd property name containing list of string domain items\n    data_item_mean: dict keyed by data item name. Mean value.\n    data_item_sd: dict keyed by data item name. Standard deviation.\n    data_item_domain: dictionary keyed by data item name. List of values.\n    drop_existing: bool. Drop existing input tables and generate new for each run.\n\n    ', 'catalogFunctionName': 'EntityDataGenerator', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'entity_data_generator'}, 'outputMeta': None, 'input': {'ids': ['73000', '73001', '73002', '73003', '73004'], 'parameters': {'data_item_mean': {'temp_set_point': 200, 'pressure': 400, 'input_flow_rate': 10, 'fuel_flow_rate': 5, 'air_flow_rate': 2}, 'drop_existing': False}}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'EntityDataGenerator', 'status': 'ACTIVE', 'description': '\n    Automatically load the entity input data table using new generated data.\n    Time series columns defined on the entity data table will be populated\n    with random data.\n\n    Optional parameters:\n\n    freq: pandas frequency string. Time series frequency.\n    scd_frequency: pandas frequency string.  Dimension change frequency.\n    activity_frequency: pandas frequency string. Activity frequency.\n    activities = dict keyed on activity name containing list of activities codes\n    scds = dict keyes on scd property name containing list of string domain items\n    data_item_mean: dict keyed by data item name. Mean value.\n    data_item_sd: dict keyed by data item name. Standard deviation.\n    data_item_domain: dictionary keyed by data item name. List of values.\n    drop_existing: bool. Drop existing input tables and generate new for each run.\n\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.EntityDataGenerator', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Returns a status flag of True when executed', 'learnMore': None, 'type': None, 'dataType': 'BOOLEAN', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'ids', 'description': 'Comma separate list of entity ids, e.g: X902-A01,X902-A03', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': ['LITERAL'], 'values': None, 'jsonSchema': {'items': {'type': 'string'}, 'maxItems': None, 'type': 'array', 'minItems': 1.0, '$schema': 'http://json-schema.org/draft-07/schema#'}, 'defaultValue': None, 'tags': []}, {'name': 'parameters', 'description': 'enter json parameters', 'learnMore': None, 'type': 'CONSTANT', 'required': False, 'dataType': 'JSON', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 927, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '7add4b1a-f9d4-43b8-bf57-57e0576d35ee', 'description': '\n    Create a new item from an expression involving other items\n    ', 'catalogFunctionName': 'PythonExpression', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_name': 'output_flow_rate'}, 'outputMeta': None, 'input': {'expression': 'df["input_flow_rate"] * df["discharge_flow_rate"]'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'PythonExpression', 'status': 'ACTIVE', 'description': '\n    Create a new item from an expression involving other items\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.PythonExpression', 'category': 'TRANSFORMER', 'output': [{'name': 'output_name', 'description': 'Output of expression', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'expression', 'description': "Define alert expression using pandas syntax. Example: df['inlet_temperature']>50", 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'LITERAL', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': ['TEXT', 'EXPRESSION']}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 932, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '30edff1b-ebb7-4ccd-a494-0edfee699297', 'description': 'Calculates the mean of the values in your data set.', 'catalogFunctionName': 'Mean', 'enabled': True, 'execStatus': False, 'granularityName': 'Industrial_boiler', 'output': {'name': 'output_flow_rate_Industrial_boiler_mean'}, 'outputMeta': None, 'input': {'source': 'output_flow_rate'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': 3618, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'Mean', 'status': 'ACTIVE', 'description': 'Calculates the mean of the values in your data set.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.aggregate.Mean', 'category': 'AGGREGATOR', 'output': [{'name': 'name', 'description': 'Enter a name for the data item that is produced as a result of this calculation.', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'source', 'description': 'Select the data item that you want to use as input for your calculation.', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 928, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'ed90af33-c8bd-438f-a8c7-22e09a24e43c', 'description': '\n    Generate random discrete numeric values.\n    ', 'catalogFunctionName': 'RandomDiscreteNumeric', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'p_leak'}, 'outputMeta': None, 'input': {'probabilities': [0.9, 0.05, 0.02, 0.02, 0.01], 'discrete_values': [0.001, 0.001, 0.001, 0.5, 0.7]}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'RandomDiscreteNumeric', 'status': 'ACTIVE', 'description': '\n    Generate random discrete numeric values.\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.RandomDiscreteNumeric', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Random output', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'discrete_values', 'description': 'Enter a list of comma separated values', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': ['NUMBER'], 'values': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'minItems': 1.0, 'items': {'type': 'number'}}, 'defaultValue': None, 'tags': []}, {'name': 'probabilities', 'description': 'Enter a list of comma separated values', 'learnMore': None, 'type': 'CONSTANT', 'required': False, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': ['NUMBER'], 'values': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'minItems': 0.0, 'items': {'type': 'number'}}, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 930, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'dfaee953-5a10-4f2d-bbc7-7e1414f155a1', 'description': 'Calculates the mean of the values in your data set.', 'catalogFunctionName': 'Mean', 'enabled': True, 'execStatus': False, 'granularityName': 'Industrial_boiler', 'output': {'name': 'pressure_Industrial_boiler_mean'}, 'outputMeta': None, 'input': {'source': 'pressure'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': 3618, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'Mean', 'status': 'ACTIVE', 'description': 'Calculates the mean of the values in your data set.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.aggregate.Mean', 'category': 'AGGREGATOR', 'output': [{'name': 'name', 'description': 'Enter a name for the data item that is produced as a result of this calculation.', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'source', 'description': 'Select the data item that you want to use as input for your calculation.', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}, {'kpiFunctionId': 924, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '7a0fac59-8d41-4254-9054-cc82c742d18a', 'description': '\n    Add random noise to one or more data items\n    ', 'catalogFunctionName': 'RandomNoise', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_items': ['temperature']}, 'outputMeta': None, 'input': {'input_items': ['temp_set_point'], 'standard_deviation': 1}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'RandomNoise', 'status': 'ACTIVE', 'description': '\n    Add random noise to one or more data items\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.RandomNoise', 'category': 'TRANSFORMER', 'output': [{'name': 'output_items', 'description': 'Chose data items to add noise to', 'learnMore': None, 'type': None, 'dataType': None, 'dataTypeFrom': 'input_items', 'dataTypeForArray': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'items': {'type': 'string'}}, 'cardinalityFrom': 'input_items', 'tags': []}], 'input': [{'name': 'input_items', 'description': 'Chose data items to add noise to', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': {'items': {'type': 'string'}, 'type': 'array', '$schema': 'http://json-schema.org/draft-07/schema#', 'minItems': 1.0}, 'defaultValue': None, 'tags': []}, {'name': 'standard_deviation', 'description': 'Standard deviation of noise', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}}] 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._set_pipeline : kpi_target_grains={'air_flow_rate_Industrial_boiler_mean': ('T', (), True, 3618), 'output_flow_rate_Industrial_boiler_mean': ('T', (), True, 3618), 'pressure_Industrial_boiler_mean': ('T', (), True, 3618)} 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] iotfunctions.db.read_sql_query : Retrieval of devices: execution time = 0.009958 s, sql = SELECT ENTITY_ID FROM "MAIN18_MAM".DM_WIOT_ENTITY_LIST WHERE ENTITY_TYPE_ID = 912 ORDER BY "ENTITY_ID" ASC 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.api._init_service : Devices of this device type: ['73000', '73001', '73002', '73003', '73004'] 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.dblogging.exists_logging_table : Logging table "MAIN18_MAM"."KPI_LOGGING" exists. 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.dblogging.check_logging_table_layout : Column definition of logging table: ('TRANSACTION_ID', 'BIGINT', '19'), ('OPERATION', 'CHAR', '8'), ('ENTITY_TYPE_ID', 'BIGINT', '19'), ('STATUS', 'CHAR', '12'), ('LOG_MESSAGE', 'VARCHAR', '1024'), ('ERROR_TYPE', 'VARCHAR', '255'), ('ERROR_MESSAGE', 'VARCHAR', '1024'), ('ERROR_STACKTRACE', 'VARCHAR', '8192'), ('LOGFILE_PATH', 'VARCHAR', '2323'), ('LOGFILE', 'CLOB', '1073741823'), ('CURRENT_STAGE_NAME', 'VARCHAR', '255'), ('CURRENT_STAGE', 'INTEGER', '10'), ('TOTAL_STAGES', 'INTEGER', '10'), ('STARTED_TS', 'TIMESTAMP', '26'), ('UPDATED_TS', 'TIMESTAMP', '26') 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.dblogging.check_logging_table_layout : Layout of logging table "MAIN18_MAM"."KPI_LOGGING" is correct. 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] analytics_service.dblogging.trim_logging_table : SQL statement to remove older entries from logging table: DELETE FROM "MAIN18_MAM"."KPI_LOGGING" WHERE ENTITY_TYPE_ID = 912 AND STATUS = 'SUCCESS' AND TRANSACTION_ID NOT IN ( SELECT TRANSACTION_ID FROM "MAIN18_MAM"."KPI_LOGGING" WHERE ENTITY_TYPE_ID = 912 AND STATUS = 'SUCCESS' ORDER BY UPDATED_TS DESC FETCH FIRST 5 ROWS ONLY ) 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] analytics_service.dblogging.trim_logging_table : SQL statement to remove older entries from logging table: DELETE FROM "MAIN18_MAM"."KPI_LOGGING" WHERE ENTITY_TYPE_ID = 912 AND STATUS != 'SUCCESS' AND TRANSACTION_ID NOT IN ( SELECT TRANSACTION_ID FROM "MAIN18_MAM"."KPI_LOGGING" WHERE ENTITY_TYPE_ID = 912 AND STATUS != 'SUCCESS' ORDER BY UPDATED_TS DESC FETCH FIRST 5 ROWS ONLY ) 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.dblogging.trim_logging_table : Older entries in logging table "MAIN18_MAM"."KPI_LOGGING" have been removed. 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.dblogging._handle_logging_table : The handling of logging table "MAIN18_MAM"."KPI_LOGGING" was successful. 
2024-10-02 05:58:05 PM [PID 1] [DEBUG  ] analytics_service.dblogging._create_initial_log_entry : Sql statement for initial entry in logging table "MAIN18_MAM"."KPI_LOGGING": INSERT INTO "MAIN18_MAM"."KPI_LOGGING" (TRANSACTION_ID, OPERATION, ENTITY_TYPE_ID, STATUS, LOG_MESSAGE, ERROR_TYPE, ERROR_MESSAGE, ERROR_STACKTRACE, LOGFILE_PATH, LOGFILE, CURRENT_STAGE_NAME, CURRENT_STAGE, TOTAL_STAGES, STARTED_TS, UPDATED_TS) VALUES (?, ?, ?, ?, ?, NULL, NULL, NULL, ?, NULL, ?, NULL, NULL, ?, CURRENT_TIMESTAMP)  [870022769286928, PIPELINE, 912, INITIALIZING, The KPI pipeline is being initialized., , InitializingPipeline, 2024-10-02 17:58:04] 
2024-10-02 05:58:05 PM [PID 1] [INFO   ] analytics_service.dblogging._create_initial_log_entry : Initial log entry has been written into logging table "MAIN18_MAM"."KPI_LOGGING" 
2024-10-02 05:58:07 PM [PID 1] [DEBUG  ] analytics_service.catalog._install : running pip install 
2024-10-02 05:58:14 PM [PID 1] [INFO   ] analytics_service.catalog._install : pip install was successful: 
 Collecting git+https://github.com/ibm-watson-iot/functions@extend_univariate
  Cloning https://github.com/ibm-watson-iot/functions (to revision extend_univariate) to /tmp/pip-req-build-g_olzmyg
  Running command git clone --filter=blob:none --quiet https://github.com/ibm-watson-iot/functions /tmp/pip-req-build-g_olzmyg
  Running command git checkout -b extend_univariate --track origin/extend_univariate
  Switched to a new branch 'extend_univariate'
  branch 'extend_univariate' set up to track 'origin/extend_univariate'.
  Resolved https://github.com/ibm-watson-iot/functions to commit 8dc8b0dbe9126f715838803d2f2a44910b5b64b2
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: dill==0.3.6 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (0.3.6)
Requirement already satisfied: ibm_db==3.1.4 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (3.1.4)
Requirement already satisfied: ibm_db_sa==0.3.9 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (0.3.9)
Requirement already satisfied: ibm-watson-machine-learning==1.0.333 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.0.333)
Requirement already satisfied: lxml==4.9.2 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (4.9.2)
Requirement already satisfied: lightgbm==3.3.5 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (3.3.5)
Requirement already satisfied: nose2==0.6.0 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (0.6.0)
Requirement already satisfied: pandas==1.5.3 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.5.3)
Requirement already satisfied: psycopg2-binary==2.9.5 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (2.9.5)
Requirement already satisfied: pyarrow==14.0.1 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (14.0.1)
Requirement already satisfied: pyod==1.0.0 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.0.0)
Requirement already satisfied: certifi>=2023.7.22 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (2024.7.4)
Requirement already satisfied: requests==2.31.0 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (2.31.0)
Requirement already satisfied: ruptures==1.1.5 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.1.5)
Requirement already satisfied: scikit-learn==1.1.1 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.1.1)
Requirement already satisfied: scikit-image==0.19.3 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (0.19.3)
Requirement already satisfied: scipy==1.11.1 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.11.1)
Requirement already satisfied: sqlalchemy==1.4.39 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.4.39)
Requirement already satisfied: statsmodels==0.13.5 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (0.13.5)
Requirement already satisfied: stumpy==1.9.2 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.9.2)
Requirement already satisfied: numpy==1.23.5 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.23.5)
Requirement already satisfied: tabulate==0.8.10 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (0.8.10)
Requirement already satisfied: urllib3==1.26.18 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (1.26.18)
Requirement already satisfied: protobuf==4.21.12 in /var/www/python_venv/lib/python3.10/site-packages (from iotfunctions==9.0.3) (4.21.12)
Requirement already satisfied: lomond in /var/www/python_venv/lib/python3.10/site-packages (from ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (0.3.3)
Requirement already satisfied: packaging in /var/www/python_venv/lib/python3.10/site-packages (from ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (24.1)
Requirement already satisfied: importlib-metadata in /var/www/python_venv/lib/python3.10/site-packages (from ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (8.4.0)
Requirement already satisfied: ibm-cos-sdk<2.14.0,>=2.12.0 in /var/www/python_venv/lib/python3.10/site-packages (from ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (2.12.0)
Requirement already satisfied: wheel in /var/www/python_venv/lib/python3.10/site-packages (from lightgbm==3.3.5->iotfunctions==9.0.3) (0.44.0)
Requirement already satisfied: six>=1.1 in /var/www/python_venv/lib/python3.10/site-packages (from nose2==0.6.0->iotfunctions==9.0.3) (1.16.0)
Requirement already satisfied: python-dateutil>=2.8.1 in /var/www/python_venv/lib/python3.10/site-packages (from pandas==1.5.3->iotfunctions==9.0.3) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /var/www/python_venv/lib/python3.10/site-packages (from pandas==1.5.3->iotfunctions==9.0.3) (2024.1)
Requirement already satisfied: joblib in /var/www/python_venv/lib/python3.10/site-packages (from pyod==1.0.0->iotfunctions==9.0.3) (1.1.1)
Requirement already satisfied: matplotlib in /var/www/python_venv/lib/python3.10/site-packages (from pyod==1.0.0->iotfunctions==9.0.3) (3.7.1)
Requirement already satisfied: numba>=0.35 in /var/www/python_venv/lib/python3.10/site-packages (from pyod==1.0.0->iotfunctions==9.0.3) (0.60.0)
Requirement already satisfied: charset-normalizer<4,>=2 in /var/www/python_venv/lib/python3.10/site-packages (from requests==2.31.0->iotfunctions==9.0.3) (3.3.2)
Requirement already satisfied: idna<4,>=2.5 in /var/www/python_venv/lib/python3.10/site-packages (from requests==2.31.0->iotfunctions==9.0.3) (3.8)
Requirement already satisfied: networkx>=2.2 in /var/www/python_venv/lib/python3.10/site-packages (from scikit-image==0.19.3->iotfunctions==9.0.3) (2.8.4)
Requirement already satisfied: pillow!=7.1.0,!=7.1.1,!=8.3.0,>=6.1.0 in /var/www/python_venv/lib/python3.10/site-packages (from scikit-image==0.19.3->iotfunctions==9.0.3) (10.4.0)
Requirement already satisfied: imageio>=2.4.1 in /var/www/python_venv/lib/python3.10/site-packages (from scikit-image==0.19.3->iotfunctions==9.0.3) (2.35.1)
Requirement already satisfied: tifffile>=2019.7.26 in /var/www/python_venv/lib/python3.10/site-packages (from scikit-image==0.19.3->iotfunctions==9.0.3) (2024.8.28)
Requirement already satisfied: PyWavelets>=1.1.1 in /var/www/python_venv/lib/python3.10/site-packages (from scikit-image==0.19.3->iotfunctions==9.0.3) (1.7.0)
Requirement already satisfied: threadpoolctl>=2.0.0 in /var/www/python_venv/lib/python3.10/site-packages (from scikit-learn==1.1.1->iotfunctions==9.0.3) (3.5.0)
Requirement already satisfied: greenlet!=0.4.17 in /var/www/python_venv/lib/python3.10/site-packages (from sqlalchemy==1.4.39->iotfunctions==9.0.3) (3.0.3)
Requirement already satisfied: patsy>=0.5.2 in /var/www/python_venv/lib/python3.10/site-packages (from statsmodels==0.13.5->iotfunctions==9.0.3) (0.5.6)
Requirement already satisfied: ibm-cos-sdk-core==2.12.0 in /var/www/python_venv/lib/python3.10/site-packages (from ibm-cos-sdk<2.14.0,>=2.12.0->ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (2.12.0)
Requirement already satisfied: ibm-cos-sdk-s3transfer==2.12.0 in /var/www/python_venv/lib/python3.10/site-packages (from ibm-cos-sdk<2.14.0,>=2.12.0->ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (2.12.0)
Requirement already satisfied: jmespath<1.0.0,>=0.10.0 in /var/www/python_venv/lib/python3.10/site-packages (from ibm-cos-sdk<2.14.0,>=2.12.0->ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (0.10.0)
Requirement already satisfied: llvmlite<0.44,>=0.43.0dev0 in /var/www/python_venv/lib/python3.10/site-packages (from numba>=0.35->pyod==1.0.0->iotfunctions==9.0.3) (0.43.0)
Requirement already satisfied: zipp>=0.5 in /var/www/python_venv/lib/python3.10/site-packages (from importlib-metadata->ibm-watson-machine-learning==1.0.333->iotfunctions==9.0.3) (3.20.1)
Requirement already satisfied: contourpy>=1.0.1 in /var/www/python_venv/lib/python3.10/site-packages (from matplotlib->pyod==1.0.0->iotfunctions==9.0.3) (1.3.0)
Requirement already satisfied: cycler>=0.10 in /var/www/python_venv/lib/python3.10/site-packages (from matplotlib->pyod==1.0.0->iotfunctions==9.0.3) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /var/www/python_venv/lib/python3.10/site-packages (from matplotlib->pyod==1.0.0->iotfunctions==9.0.3) (4.53.1)
Collecting kiwisolver>=1.0.1 (from matplotlib->pyod==1.0.0->iotfunctions==9.0.3)
  Downloading kiwisolver-1.4.7-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl.metadata (6.3 kB)
Requirement already satisfied: pyparsing>=2.3.1 in /var/www/python_venv/lib/python3.10/site-packages (from matplotlib->pyod==1.0.0->iotfunctions==9.0.3) (3.1.4)
Downloading kiwisolver-1.4.7-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 1.6/1.6 MB 45.2 MB/s eta 0:00:00
Building wheels for collected packages: iotfunctions
  Building wheel for iotfunctions (setup.py): started
  Building wheel for iotfunctions (setup.py): finished with status 'done'
  Created wheel for iotfunctions: filename=iotfunctions-9.0.3-py3-none-any.whl size=258042 sha256=0b59a6efedc9d1606e299fce11707bfd31cf38cabb0d86088f0d08711114cd20
  Stored in directory: /tmp/pip-ephem-wheel-cache-3q6r9zg4/wheels/25/1a/4b/63f358fc92b7584023d84defcea72393a9ad862c670ae70762
Successfully built iotfunctions
Installing collected packages: kiwisolver, iotfunctions
  Attempting uninstall: iotfunctions
    Found existing installation: iotfunctions 9.0.0
    Uninstalling iotfunctions-9.0.0:
      Successfully uninstalled iotfunctions-9.0.0
Successfully installed iotfunctions-9.0.3 kiwisolver-1.4.7

[notice] A new release of pip is available: 24.0 -> 24.2
[notice] To update, run: pip install --upgrade pip
 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] matplotlib.wrapper : matplotlib data path: /var/www/python_venv/lib/python3.10/site-packages/matplotlib/mpl-data 
2024-10-02 05:58:15 PM [PID 1] [WARNING] matplotlib._get_config_or_cache_dir : Matplotlib created a temporary config/cache directory at /tmp/matplotlib-3fbfzv1y because the default path (/.config/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing. 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] matplotlib.wrapper : CONFIGDIR=/tmp/matplotlib-3fbfzv1y 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] matplotlib.<module> : interactive is False 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] matplotlib.<module> : platform is linux 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.catalog.load_custom_functions : transformers=['EntityDataGenerator', 'PythonExpression', 'PythonFunction', 'RandomDiscreteNumeric', 'RandomNoise', 'RandomUniform', 'SpectralAnomalyScore'] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.catalog.load_custom_functions : alerts=[] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.catalog.load_custom_functions : aggregators=['Mean:None'] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.dbtables._cache_table_exists : Table "MAIN18_MAM"."KPI_DATA_CACHE" exists. 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.__init__ : Constants: {constant_name} = {constant_value} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.metadata.__init__ : Initializing new entity type using iotfunctions 9.0.0 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.__init__ : Starting trace 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.__init__ : Trace name: auto_trace_Industrial_boiler_20241002175815 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.__init__ : auto_save None 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.categorize_args : categorizing arguments 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.get_table : Table name = IOT_INDUSTRIAL_BOILER_912 , self.metadata = MetaData(bind=Engine(db2+ibm_db://db2inst1:***@c-mas-montest18-system-db2u-engn-svc.db2u.svc:50001/BLUDB;SECURITY=ssl;SSLServerCertificate=/var/www/as-pipeline/db2_certificate.pem;))   
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.metadata.__init__ : Initialized entity type 
EntityType:IOT_INDUSTRIAL_BOILER_912
Functions:
Granularities:
No schedules metadata 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.util.__init__ : Device to offset mapping: [('73000', Timedelta('0 days 00:00:00')), ('73001', Timedelta('0 days 00:00:00')), ('73002', Timedelta('0 days 00:00:00')), ('73003', Timedelta('0 days 00:00:00')), ('73004', Timedelta('0 days 00:00:00'))] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.util.__init__ : Offset to device mapping: [(Timedelta('0 days 00:00:00'), ['73000', '73001', '73002', '73003', '73004'])] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.util.__init__ : Minimum offset=0 days 00:00:00, maximum offset=0 days 00:00:00 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : raw_metrics_set={'format', 'logicalinterface_id', 'fuel_flow_rate', 'input_flow_rate', 'evt_timestamp', 'firmware', 'manufacturer', 'pressure', 'devicetype', 'updated_utc', 'eventtype', 'ENTITY_ID', 'evt_timestamp_dim', 'temp_set_point', 'company_code', 'deviceid', 'air_flow_rate'}, derived_metrics_set={'temperature', 'demo_output_metric', 'air_flow_rate_Industrial_boiler_mean', 'discharge_perc', 'pressure_Industrial_boiler_mean', 'discharge_flow_rate', 'output_flow_rate', 'entity_data_generator', 'A_temp_anomaly', 'p_leak', 'output_flow_rate_Industrial_boiler_mean'} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['A_temp_anomaly'], kpi_raw_sources=set(), kpi_derived_sources={'temperature'}, kpi={'kpiFunctionId': 933, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '1b38550f-84a4-4f56-b5e0-8c6b14b66bb0', 'description': 'An unsupervised anomaly detection function.\n     Applies a spectral analysis clustering techniqueto extract features from time series data and to create z scores.\n     Moves a sliding window across the data signal and applies the anomalymodelto each window.\n     The window size is typically set to 12 data points.\n     Try several anomaly detectors on your data and use the one that fits your data best.', 'catalogFunctionName': 'SpectralAnomalyScore', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'A_temp_anomaly'}, 'outputMeta': {'A_temp_anomaly': {'transient': False}}, 'input': {'input_item': 'temperature', 'windowsize': 12}, 'inputMeta': None, 'scope': None, 'schedule': {}, 'backtrack': {}, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'SpectralAnomalyScore', 'status': 'ACTIVE', 'description': 'An unsupervised anomaly detection function.\n     Applies a spectral analysis clustering techniqueto extract features from time series data and to create z scores.\n     Moves a sliding window across the data signal and applies the anomalymodelto each window.\n     The window size is typically set to 12 data points.\n     Try several anomaly detectors on your data and use the one that fits your data best.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.anomaly.SpectralAnomalyScore', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Anomaly score (zScore)', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'windowsize', 'description': 'Window size for spectral analysis - default 12', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}, {'name': 'input_item', 'description': 'Column for feature extraction', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': 'git+https://github.com/ibm-watson-iot/functions@extend_univariate', 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['air_flow_rate_Industrial_boiler_mean'], kpi_raw_sources={'air_flow_rate'}, kpi_derived_sources=set(), kpi={'kpiFunctionId': 931, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '15145ab5-d91d-4235-850c-f9625b111aab', 'description': 'Calculates the mean of the values in your data set.', 'catalogFunctionName': 'Mean', 'enabled': True, 'execStatus': False, 'granularityName': ('T', (), True, 3618), 'output': {'name': 'air_flow_rate_Industrial_boiler_mean'}, 'outputMeta': None, 'input': {'source': 'air_flow_rate'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': 3618, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'Mean', 'status': 'ACTIVE', 'description': 'Calculates the mean of the values in your data set.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.aggregate.Mean', 'category': 'AGGREGATOR', 'output': [{'name': 'name', 'description': 'Enter a name for the data item that is produced as a result of this calculation.', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'source', 'description': 'Select the data item that you want to use as input for your calculation.', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['demo_output_metric'], kpi_raw_sources={'pressure', 'air_flow_rate'}, kpi_derived_sources=set(), kpi={'kpiFunctionId': 929, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'f9e04da2-813b-4e4a-bc79-e49b63d059d4', 'description': "\n    Execute a paste-in function. A paste-in function is python function declaration\n    code block. The function must be called 'f' and accept two inputs:\n    df (a pandas DataFrame) and parameters (a dict that you can use\n    to externalize the configuration of the function).\n\n    The function can return a DataFrame,Series,NumpyArray or scalar value.\n\n    Example:\n    def f(df,parameters):\n        #  generate an 2-D array of random numbers\n        output = np.random.normal(1,0.1,len(df.index))\n        return output\n\n    Function source may be pasted in or retrieved from Cloud Object Storage.\n\n    PythonFunction is currently experimental.\n    ", 'catalogFunctionName': 'PythonFunction', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'demo_output_metric'}, 'outputMeta': {'demo_output_metric': {'dataType': 'NUMBER', 'transient': False}}, 'input': {'function_code': "def f(df, parameters):\n    \n    output =df['air_flow_rate'] + ( df['pressure'] - 400. )\n    return output", 'input_items': ['air_flow_rate', 'pressure']}, 'inputMeta': None, 'scope': None, 'schedule': {'every': '5T', 'starting_at': '00:00:00'}, 'backtrack': {'days': 2}, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'PythonFunction', 'status': 'ACTIVE', 'description': "\n    Execute a paste-in function. A paste-in function is python function declaration\n    code block. The function must be called 'f' and accept two inputs:\n    df (a pandas DataFrame) and parameters (a dict that you can use\n    to externalize the configuration of the function).\n\n    The function can return a DataFrame,Series,NumpyArray or scalar value.\n\n    Example:\n    def f(df,parameters):\n        #  generate an 2-D array of random numbers\n        output = np.random.normal(1,0.1,len(df.index))\n        return output\n\n    Function source may be pasted in or retrieved from Cloud Object Storage.\n\n    PythonFunction is currently experimental.\n    ", 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.PythonFunction', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Choose an item name for the function output', 'learnMore': None, 'type': None, 'dataType': None, 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'parameters', 'description': 'optional parameters specified in json format', 'learnMore': None, 'type': 'CONSTANT', 'required': False, 'dataType': 'JSON', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}, {'name': 'input_items', 'description': 'Choose one or more data item to use as a function input', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'minItems': 1.0, 'items': {'type': 'string'}}, 'defaultValue': None, 'tags': []}, {'name': 'function_code', 'description': 'Paste in your function definition', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'LITERAL', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': ['TEXT']}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.get_fn_expression_args : Found expression df["input_flow_rate"] * df["discharge_perc"] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['discharge_flow_rate'], kpi_raw_sources={'input_flow_rate'}, kpi_derived_sources={'discharge_perc'}, kpi={'kpiFunctionId': 926, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'e363d78e-48f0-432e-93f1-f694a137cb4d', 'description': '\n    Create a new item from an expression involving other items\n    ', 'catalogFunctionName': 'PythonExpression', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_name': 'discharge_flow_rate'}, 'outputMeta': None, 'input': {'expression': 'df["input_flow_rate"] * df["discharge_perc"]'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'PythonExpression', 'status': 'ACTIVE', 'description': '\n    Create a new item from an expression involving other items\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.PythonExpression', 'category': 'TRANSFORMER', 'output': [{'name': 'output_name', 'description': 'Output of expression', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'expression', 'description': "Define alert expression using pandas syntax. Example: df['inlet_temperature']>50", 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'LITERAL', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': ['TEXT', 'EXPRESSION']}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['discharge_perc'], kpi_raw_sources=set(), kpi_derived_sources=set(), kpi={'kpiFunctionId': 925, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '52d38a2d-b3fd-4704-b58d-df083472001d', 'description': '\n    Generate a uniformally distributed random number.\n    ', 'catalogFunctionName': 'RandomUniform', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'discharge_perc'}, 'outputMeta': None, 'input': {'min_value': 0.1, 'max_value': 0.2}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'RandomUniform', 'status': 'ACTIVE', 'description': '\n    Generate a uniformally distributed random number.\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.RandomUniform', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Random output', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'min_value', 'description': 'Enter a constant value', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}, {'name': 'max_value', 'description': 'Enter a constant value', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['entity_data_generator'], kpi_raw_sources=set(), kpi_derived_sources=set(), kpi={'kpiFunctionId': 923, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '777d0069-d354-4a3a-97d9-1e2b58d387b8', 'description': '\n    Automatically load the entity input data table using new generated data.\n    Time series columns defined on the entity data table will be populated\n    with random data.\n\n    Optional parameters:\n\n    freq: pandas frequency string. Time series frequency.\n    scd_frequency: pandas frequency string.  Dimension change frequency.\n    activity_frequency: pandas frequency string. Activity frequency.\n    activities = dict keyed on activity name containing list of activities codes\n    scds = dict keyes on scd property name containing list of string domain items\n    data_item_mean: dict keyed by data item name. Mean value.\n    data_item_sd: dict keyed by data item name. Standard deviation.\n    data_item_domain: dictionary keyed by data item name. List of values.\n    drop_existing: bool. Drop existing input tables and generate new for each run.\n\n    ', 'catalogFunctionName': 'EntityDataGenerator', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'entity_data_generator'}, 'outputMeta': None, 'input': {'ids': ['73000', '73001', '73002', '73003', '73004'], 'parameters': {'data_item_mean': {'temp_set_point': 200, 'pressure': 400, 'input_flow_rate': 10, 'fuel_flow_rate': 5, 'air_flow_rate': 2}, 'drop_existing': False}}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'EntityDataGenerator', 'status': 'ACTIVE', 'description': '\n    Automatically load the entity input data table using new generated data.\n    Time series columns defined on the entity data table will be populated\n    with random data.\n\n    Optional parameters:\n\n    freq: pandas frequency string. Time series frequency.\n    scd_frequency: pandas frequency string.  Dimension change frequency.\n    activity_frequency: pandas frequency string. Activity frequency.\n    activities = dict keyed on activity name containing list of activities codes\n    scds = dict keyes on scd property name containing list of string domain items\n    data_item_mean: dict keyed by data item name. Mean value.\n    data_item_sd: dict keyed by data item name. Standard deviation.\n    data_item_domain: dictionary keyed by data item name. List of values.\n    drop_existing: bool. Drop existing input tables and generate new for each run.\n\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.EntityDataGenerator', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Returns a status flag of True when executed', 'learnMore': None, 'type': None, 'dataType': 'BOOLEAN', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'ids', 'description': 'Comma separate list of entity ids, e.g: X902-A01,X902-A03', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': ['LITERAL'], 'values': None, 'jsonSchema': {'items': {'type': 'string'}, 'maxItems': None, 'type': 'array', 'minItems': 1.0, '$schema': 'http://json-schema.org/draft-07/schema#'}, 'defaultValue': None, 'tags': []}, {'name': 'parameters', 'description': 'enter json parameters', 'learnMore': None, 'type': 'CONSTANT', 'required': False, 'dataType': 'JSON', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.get_fn_expression_args : Found expression df["input_flow_rate"] * df["discharge_flow_rate"] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['output_flow_rate'], kpi_raw_sources={'input_flow_rate'}, kpi_derived_sources={'discharge_flow_rate'}, kpi={'kpiFunctionId': 927, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '7add4b1a-f9d4-43b8-bf57-57e0576d35ee', 'description': '\n    Create a new item from an expression involving other items\n    ', 'catalogFunctionName': 'PythonExpression', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_name': 'output_flow_rate'}, 'outputMeta': None, 'input': {'expression': 'df["input_flow_rate"] * df["discharge_flow_rate"]'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'PythonExpression', 'status': 'ACTIVE', 'description': '\n    Create a new item from an expression involving other items\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.PythonExpression', 'category': 'TRANSFORMER', 'output': [{'name': 'output_name', 'description': 'Output of expression', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'expression', 'description': "Define alert expression using pandas syntax. Example: df['inlet_temperature']>50", 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'LITERAL', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': ['TEXT', 'EXPRESSION']}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['output_flow_rate_Industrial_boiler_mean'], kpi_raw_sources=set(), kpi_derived_sources={'output_flow_rate'}, kpi={'kpiFunctionId': 932, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '30edff1b-ebb7-4ccd-a494-0edfee699297', 'description': 'Calculates the mean of the values in your data set.', 'catalogFunctionName': 'Mean', 'enabled': True, 'execStatus': False, 'granularityName': ('T', (), True, 3618), 'output': {'name': 'output_flow_rate_Industrial_boiler_mean'}, 'outputMeta': None, 'input': {'source': 'output_flow_rate'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': 3618, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'Mean', 'status': 'ACTIVE', 'description': 'Calculates the mean of the values in your data set.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.aggregate.Mean', 'category': 'AGGREGATOR', 'output': [{'name': 'name', 'description': 'Enter a name for the data item that is produced as a result of this calculation.', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'source', 'description': 'Select the data item that you want to use as input for your calculation.', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['p_leak'], kpi_raw_sources=set(), kpi_derived_sources=set(), kpi={'kpiFunctionId': 928, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'ed90af33-c8bd-438f-a8c7-22e09a24e43c', 'description': '\n    Generate random discrete numeric values.\n    ', 'catalogFunctionName': 'RandomDiscreteNumeric', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_item': 'p_leak'}, 'outputMeta': None, 'input': {'probabilities': [0.9, 0.05, 0.02, 0.02, 0.01], 'discrete_values': [0.001, 0.001, 0.001, 0.5, 0.7]}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'RandomDiscreteNumeric', 'status': 'ACTIVE', 'description': '\n    Generate random discrete numeric values.\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.RandomDiscreteNumeric', 'category': 'TRANSFORMER', 'output': [{'name': 'output_item', 'description': 'Random output', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'discrete_values', 'description': 'Enter a list of comma separated values', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': ['NUMBER'], 'values': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'minItems': 1.0, 'items': {'type': 'number'}}, 'defaultValue': None, 'tags': []}, {'name': 'probabilities', 'description': 'Enter a list of comma separated values', 'learnMore': None, 'type': 'CONSTANT', 'required': False, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': ['NUMBER'], 'values': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'minItems': 0.0, 'items': {'type': 'number'}}, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['pressure_Industrial_boiler_mean'], kpi_raw_sources={'pressure'}, kpi_derived_sources=set(), kpi={'kpiFunctionId': 930, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': 'dfaee953-5a10-4f2d-bbc7-7e1414f155a1', 'description': 'Calculates the mean of the values in your data set.', 'catalogFunctionName': 'Mean', 'enabled': True, 'execStatus': False, 'granularityName': ('T', (), True, 3618), 'output': {'name': 'pressure_Industrial_boiler_mean'}, 'outputMeta': None, 'input': {'source': 'pressure'}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': 3618, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'Mean', 'status': 'ACTIVE', 'description': 'Calculates the mean of the values in your data set.', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.aggregate.Mean', 'category': 'AGGREGATOR', 'output': [{'name': 'name', 'description': 'Enter a name for the data item that is produced as a result of this calculation.', 'learnMore': None, 'type': None, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'jsonSchema': None, 'cardinalityFrom': None, 'tags': []}], 'input': [{'name': 'source', 'description': 'Select the data item that you want to use as input for your calculation.', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : kpi_derived_metrics = ['temperature'], kpi_raw_sources={'temp_set_point'}, kpi_derived_sources=set(), kpi={'kpiFunctionId': 924, 'resourceId': 912, 'tenantId': 'main18', 'templateKpiId': None, 'name': '7a0fac59-8d41-4254-9054-cc82c742d18a', 'description': '\n    Add random noise to one or more data items\n    ', 'catalogFunctionName': 'RandomNoise', 'enabled': True, 'execStatus': False, 'granularityName': None, 'output': {'output_items': ['temperature']}, 'outputMeta': None, 'input': {'input_items': ['temp_set_point'], 'standard_deviation': 1}, 'inputMeta': None, 'scope': None, 'schedule': None, 'backtrack': None, 'granularitySetId': None, 'catalogFunctionVersion': None, 'catalogFunctionDto': {'name': 'RandomNoise', 'status': 'ACTIVE', 'description': '\n    Add random noise to one or more data items\n    ', 'learnMore': None, 'moduleAndTargetName': 'iotfunctions.bif.RandomNoise', 'category': 'TRANSFORMER', 'output': [{'name': 'output_items', 'description': 'Chose data items to add noise to', 'learnMore': None, 'type': None, 'dataType': None, 'dataTypeFrom': 'input_items', 'dataTypeForArray': None, 'jsonSchema': {'$schema': 'http://json-schema.org/draft-07/schema#', 'type': 'array', 'items': {'type': 'string'}}, 'cardinalityFrom': 'input_items', 'tags': []}], 'input': [{'name': 'input_items', 'description': 'Chose data items to add noise to', 'learnMore': None, 'type': 'DATA_ITEM', 'required': True, 'dataType': 'ARRAY', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': {'items': {'type': 'string'}, 'type': 'array', '$schema': 'http://json-schema.org/draft-07/schema#', 'minItems': 1.0}, 'defaultValue': None, 'tags': []}, {'name': 'standard_deviation', 'description': 'Standard deviation of noise', 'learnMore': None, 'type': 'CONSTANT', 'required': True, 'dataType': 'NUMBER', 'dataTypeFrom': None, 'dataTypeForArray': None, 'values': None, 'jsonSchema': None, 'defaultValue': None, 'tags': []}], 'url': None, 'tags': [], 'incrementalUpdate': None, 'image': None, 'version': 'V1'}} 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: A_temp_anomaly 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: demo_output_metric 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: discharge_flow_rate 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: discharge_perc 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: entity_data_generator 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: output_flow_rate 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: p_leak 
2024-10-02 05:58:15 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.parse_kpi_dependency_tree : found transformer without granularity: temperature 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.get_kpi_dependency_tree_processing_queue : kpi_dependencies = 
    (1) air_flow_rate_Industrial_boiler_mean <- ['(0) air_flow_rate']
    (1) demo_output_metric <- ['(0) pressure', '(0) air_flow_rate']
    (1) discharge_perc <- []
    (1) entity_data_generator <- []
    (1) p_leak <- []
    (1) pressure_Industrial_boiler_mean <- ['(0) pressure']
    (1) temperature <- ['(0) temp_set_point']
    (2) A_temp_anomaly <- ['(1) temperature']
    (2) discharge_flow_rate <- ['(0) input_flow_rate', '(1) discharge_perc']
    (3) output_flow_rate <- ['(0) input_flow_rate', '(2) discharge_flow_rate']
    (4) output_flow_rate_Industrial_boiler_mean <- ['(3) output_flow_rate'] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.read_sql_query : get_last_execution_time: execution time = 0.00502 s, sql = SELECT TIMESTAMP AS "last_timestamp" FROM "MAIN18_MAM".KPI_CHECKPOINT WHERE "ENTITY_TYPE_ID" = 912 AND "ENTITY_ID" = '' 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.execute_kpi_pipelines : previous_launch_date = 2024-10-02 17:53:04 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.util.next_schedule : now=2024-10-02 17:53:04, interval_start=2024-01-01 00:00:00, interval=<5 * Minutes>, next_schedule=2024-10-02 17:55:00 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : KPIs without schedule: ['temperature', 'air_flow_rate_Industrial_boiler_mean', 'discharge_perc', 'pressure_Industrial_boiler_mean', 'discharge_flow_rate', 'output_flow_rate', 'entity_data_generator', 'A_temp_anomaly', 'p_leak', 'output_flow_rate_Industrial_boiler_mean'] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : KPIs with due schedule: ['demo_output_metric'] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : KPIs with undue schedule: [] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : metric=demo_output_metric, backpoint=2024-09-30 17:58:04, time_delta=2 days 00:00:00 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : Before adjustment: earliest_backpoint=2024-09-30 17:58:04, schedule_starting_at={'hour': 0, 'minute': 0, 'second': 0, 'microsecond': 0, 'nanosecond': 0} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : After adjustment to maximum grain T: earliest_backpoint=2024-09-30 17:58:00 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : After adjustment by schedule_starting_at {'hour': 0, 'minute': 0, 'second': 0, 'microsecond': 0, 'nanosecond': 0}: earliest_backpoint=2024-09-30 00:00:00 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : After adjustments: earliest_backpoint=2024-09-30 00:00:00, schedule_starting_at={'hour': 0, 'minute': 0, 'second': 0, 'microsecond': 0, 'nanosecond': 0} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : kpi_stage_processing_nonagg_queue = 
    (1) demo_output_metric <- ['(0) pressure', '(0) air_flow_rate'], func=PythonFunction
    (1) discharge_perc <- [], func=RandomUniform
    (1) entity_data_generator <- [], func=EntityDataGenerator
    (1) p_leak <- [], func=RandomDiscreteNumeric
    (1) temperature <- ['(0) temp_set_point'], func=RandomNoise
    (2) A_temp_anomaly <- ['(1) temperature'], func=SpectralAnomalyScore
    (2) discharge_flow_rate <- ['(0) input_flow_rate', '(1) discharge_perc'], func=PythonExpression
    (3) output_flow_rate <- ['(0) input_flow_rate', '(2) discharge_flow_rate'], func=PythonExpression 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : kpi_stage_processing_agg_queue=
    ('T', (), True, 3618)={
        None:[
            (1) air_flow_rate_Industrial_boiler_mean <- ['(0) air_flow_rate'],
            (1) pressure_Industrial_boiler_mean <- ['(0) pressure'],
            (4) output_flow_rate_Industrial_boiler_mean <- ['(3) output_flow_rate'],
    ]} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : grain_sequence_dependency_queue={None: {('T', (), True, 3618)}} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : grain_sequence=[('T', (), True, 3618)] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.calc_execution_intervals : The environment variable INTERVAL_WIDTH is set and overwrites the default chunking size of 5 days by 5 days. 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.execute_kpi_pipelines : Pipeline is executed in 1 cycles: 
cycle=1, start=2024-09-30 00:00:00, end=2024-10-05 00:00:00 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.dblogging.set_total_stages : Sql statement to update column TOTAL_STAGES in logging table: UPDATE "MAIN18_MAM"."KPI_LOGGING" SET TOTAL_STAGES = ?, UPDATED_TS = CURRENT_TIMESTAMP WHERE TRANSACTION_ID = ?  [19, 870022769286928] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.dblogging.set_total_stages : Column TOTAL_STAGES in logging table "MAIN18_MAM"."KPI_LOGGING" has been updated with value 19 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.execute_kpi_pipelines : 
########################################################################################
 Calculation cycle 1 out of 1: Time interval (UTC) [2024-09-30 00:00:00, 2024-10-05 00:00:00] 
######################################################################################## 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function RandomDiscreteNumeric 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function EntityDataGenerator 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function RandomUniform 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function PythonFunction 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function RandomNoise 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function SpectralAnomalyScore 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.__init__ : temperature 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.__init__ : temperature 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.get_fn_expression_args : Found expression df["input_flow_rate"] * df["discharge_perc"] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function PythonExpression 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.base.parse_expression : expression (df["input_flow_rate"] * df["discharge_perc"]) 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.get_fn_expression_args : Found expression df["input_flow_rate"] * df["discharge_flow_rate"] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.get_transformer_stage : Initializing Transformation function PythonExpression 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.base.parse_expression : expression (df["input_flow_rate"] * df["discharge_flow_rate"]) 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.generate_pipeline_stages : all required columns={'discharge_perc', 'input_flow_rate', 'temperature', 'discharge_flow_rate', 'temp_set_point', 'pressure', 'air_flow_rate'}, all generated columns=['p_leak', 'entity_data_generator', 'discharge_perc', 'demo_output_metric', 'temperature', 'A_temp_anomaly', 'discharge_flow_rate', 'output_flow_rate'], all exchanged columns=[], all required columns of loaders=set(), all generated columns of loaders=[] 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] iotfunctions.stages.__init__ : alerts going to database = []  
2024-10-02 05:58:15 PM [PID 1] [INFO   ] iotfunctions.stages.__init__ : alerts going to message hub = []  
2024-10-02 05:58:15 PM [PID 1] [INFO   ] iotfunctions.util.__init__ : EventStreams ca certificate is empty. 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.generate_pipeline_stages : pipeline_stages=['RandomDiscreteNumeric', 'EntityDataGenerator', 'RandomUniform', 'PythonFunction', 'RandomNoise', 'SpectralAnomalyScore', 'PythonExpression', 'PythonExpression', 'PersistColumns', 'ProduceAlerts'] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._extract_preload_stages : Extracted preload stage EntityDataGenerator from pipeline 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_preload_stages : Start of stage {{ EntityDataGenerator }} 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_preload_stages : === Executing stage EntityDataGenerator === 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.metadata.generate_data : Generating data for IOT_INDUSTRIAL_BOILER_912 with metrics ['air_flow_rate', 'input_flow_rate', 'pressure', 'temp_set_point', 'fuel_flow_rate'] and dimensions ['eventtype', 'company_code'] and dates [] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.automation.get_data : Generated 792 rows of time series data from 2024-09-30 00:00:00.000573 to 2024-10-02 17:58:15.628900 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.get_table : Table name = IOT_INDUSTRIAL_BOILER_912_CTG , self.metadata = MetaData(bind=Engine(db2+ibm_db://db2inst1:***@c-mas-montest18-system-db2u-engn-svc.db2u.svc:50001/BLUDB;SECURITY=ssl;SSLServerCertificate=/var/www/as-pipeline/db2_certificate.pem;))   
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.get_table : Table name = IOT_INDUSTRIAL_BOILER_912_CTG , self.metadata = MetaData(bind=Engine(db2+ibm_db://db2inst1:***@c-mas-montest18-system-db2u-engn-svc.db2u.svc:50001/BLUDB;SECURITY=ssl;SSLServerCertificate=/var/www/as-pipeline/db2_certificate.pem;))   
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.query : query statement: SELECT "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".firmware AS "MAIN18_MAM_IOT_INDUSTRIAL_BOILER_912_CTG_firmware", "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".evt_timestamp_dim AS "MAIN18_MAM_IOT_INDUSTRIAL_BOILER_912_CTG_evt_timestamp_dim", "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".manufacturer AS "MAIN18_MAM_IOT_INDUSTRIAL_BOILER_912_CTG_manufacturer", "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".deviceid AS "MAIN18_MAM_IOT_INDUSTRIAL_BOILER_912_CTG_deviceid", "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".devicetype AS "MAIN18_MAM_IOT_INDUSTRIAL_BOILER_912_CTG_devicetype" 
FROM "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG" 
WHERE "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".deviceid IN (__[POSTCOMPILE_deviceid_1]) 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.read_sql_query : The following sql statement returned 5 records and was executed in 0.00569 seconds: SELECT "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".firmware, "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".evt_timestamp_dim, "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".manufacturer, "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".deviceid, "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".devicetype 
FROM "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG" 
WHERE "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".deviceid IN (__[POSTCOMPILE_deviceid_1]). 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : Returned data frame: = (5, 5) 
Data types of index: {0: dtype('int64')} 
Data types of columns: {'deviceid': dtype('O'), 'devicetype': dtype('O'), 'evt_timestamp_dim': dtype('<M8[ns]'), 'firmware': dtype('O'), 'manufacturer': dtype('O')} 
+----+------------+----------------------------+----------------+------------+-------------------+
|    |   firmware | evt_timestamp_dim          | manufacturer   |   deviceid | devicetype        |
|----+------------+----------------------------+----------------+------------+-------------------|
|  0 |       1.12 | 2024-09-08 23:58:13.444305 | GHI Industries |      73004 | Industrial_boiler |
|  1 |       1.13 | 2024-09-01 08:26:38.031873 | Rentech        |      73002 | Industrial_boiler |
|  2 |       2.1  | 2024-09-07 15:56:58.794973 | GHI Industries |      73003 | Industrial_boiler |
|  3 |       2.1  | 2024-08-22 13:04:59.370164 | GHI Industries |      73000 | Industrial_boiler |
|  4 |       2.1  | 2024-08-27 05:43:52.308322 | GHI Industries |      73001 | Industrial_boiler |
+----+------------+----------------------------+----------------+------------+-------------------+ 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.metadata.generate_dimension_data : No new entities. Did not generate dimension data. 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.get_table : Table name = IOT_INDUSTRIAL_BOILER_912 , self.metadata = MetaData(bind=Engine(db2+ibm_db://db2inst1:***@c-mas-montest18-system-db2u-engn-svc.db2u.svc:50001/BLUDB;SECURITY=ssl;SSLServerCertificate=/var/www/as-pipeline/db2_certificate.pem;))   
/var/www/python_venv/lib/python3.10/site-packages/iotfunctions/db.py:2951: UserWarning: The provided table name 'IOT_INDUSTRIAL_BOILER_912' is not found exactly as such in the database after writing the table, possibly due to case sensitivity issues. Consider using lower case table names.
  
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.db.write_frame : Wrote data to table IOT_INDUSTRIAL_BOILER_912  
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_preload_stages : End of stage {{ EntityDataGenerator }}, execution time = 0.222721 s 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : removed preload stages from pipeline 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.get_fn_expression_args : Found expression df["input_flow_rate"] * df["discharge_perc"] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] iotfunctions.util.get_fn_expression_args : Found expression df["input_flow_rate"] * df["discharge_flow_rate"] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.get_data : data_items={'input_flow_rate', 'discharge_perc', 'discharge_flow_rate', 'temp_set_point', 'pressure', 'air_flow_rate'}, start_ts_tz={Timedelta('0 days 00:00:00'): Timestamp('2024-09-30 00:00:00')}, end_ts_tz={Timedelta('0 days 00:00:00'): Timestamp('2024-10-02 17:58:04')}, entities_tz={Timedelta('0 days 00:00:00'): ['73000', '73001', '73002', '73003', '73004']} 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService.get_data : raw_data_items=['air_flow_rate', 'input_flow_rate', 'pressure', 'temp_set_point'], dimension_data_items=[] 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.clean_checkpoints : clean_checkpoints_sql = DELETE FROM "MAIN18_MAM".kpi_checkpoint WHERE "ENTITY_TYPE_ID" = 912 AND KEY IN ('temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate') 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService.clean_checkpoints : Checkpoints have been deleted from KPI_CHECKPOINT table 
2024-10-02 05:58:15 PM [PID 1] [INFO   ] iotfunctions.dbtables.delete_all_caches : All caches have been deleted from table "MAIN18_MAM"."KPI_DATA_CACHE" for entity type id 912 
2024-10-02 05:58:15 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.get_data : offset=0 days 00:00:00, updated_entities=['73000', '73001', '73002', '73003', '73004'], start_ts=2024-09-30 00:00:00, end_ts=2024-10-02 17:58:04 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.db.read_sql_query : get_metric_data: execution time = 0.238311 s, sql = SELECT "DEVICEID" AS "ID", "EVT_TIMESTAMP" AS "EVT_TIMESTAMP", "TEMP_SET_POINT" AS "TEMP_SET_POINT", "INPUT_FLOW_RATE" AS "INPUT_FLOW_RATE", "PRESSURE" AS "PRESSURE", "AIR_FLOW_RATE" AS "AIR_FLOW_RATE" FROM "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912" WHERE "DEVICEID" IS NOT NULL AND "EVT_TIMESTAMP" IS NOT NULL AND "DEVICEID" IN ('73000','73001','73002','73003','73004') AND "EVT_TIMESTAMP" >= '2024-09-30 00:00:00' AND "EVT_TIMESTAMP" < '2024-10-02 17:58:04' AND ( "TEMP_SET_POINT" IS NOT NULL OR "INPUT_FLOW_RATE" IS NOT NULL OR "PRESSURE" IS NOT NULL OR "AIR_FLOW_RATE" IS NOT NULL ) ORDER BY "ID", "EVT_TIMESTAMP" ASC 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.get_metric_data : get_metric_data: number of loaded records = 10217, execution time = 0.244583 s 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : updated_entities_df for offset 0 days 00:00:00: = (10217, 6) 
Data types of index: {0: dtype('int64')} 
Data types of columns: {'air_flow_rate': dtype('float64'), 'evt_timestamp': dtype('<M8[ns]'), 'id': dtype('O'), 'input_flow_rate': dtype('float64'), 'pressure': dtype('float64'), 'temp_set_point': dtype('float64')} 
+----+-------+----------------------------+------------------+-------------------+------------+-----------------+
|    |    id | evt_timestamp              |   temp_set_point |   input_flow_rate |   pressure |   air_flow_rate |
|----+-------+----------------------------+------------------+-------------------+------------+-----------------|
|  0 | 73000 | 2024-09-30 00:00:00.000194 |          200.897 |          10.544   |    400.874 |         2.84293 |
|  1 | 73000 | 2024-09-30 00:05:00.000278 |          201.946 |          10.5459  |    401.6   |         2.21161 |
|  2 | 73000 | 2024-09-30 00:05:00.000302 |          199.965 |           9.63343 |    402.127 |         1.66454 |
|  3 | 73000 | 2024-09-30 00:05:00.000573 |          199.972 |          11.7223  |    400.171 |         2.74505 |
|  4 | 73000 | 2024-09-30 00:10:00.000204 |          200.769 |           9.88221 |    400.756 |         2.72133 |
+----+-------+----------------------------+------------------+-------------------+------------+-----------------+
+-------+-------+----------------------------+------------------+-------------------+------------+-----------------+
|       |    id | evt_timestamp              |   temp_set_point |   input_flow_rate |   pressure |   air_flow_rate |
|-------+-------+----------------------------+------------------+-------------------+------------+-----------------|
| 10212 | 73004 | 2024-10-02 17:20:00.000332 |          200.526 |           9.38749 |    400.703 |         2.75582 |
| 10213 | 73004 | 2024-10-02 17:40:00.000213 |          201.112 |          11.2731  |    400.729 |         2.8278  |
| 10214 | 73004 | 2024-10-02 17:45:00.000213 |          199.812 |           8.65681 |    402.277 |         2.87294 |
| 10215 | 73004 | 2024-10-02 17:45:00.000573 |          202.513 |          10.3489  |    400.733 |         2.89217 |
| 10216 | 73004 | 2024-10-02 17:50:00.000573 |          200.581 |          10.5041  |    401.761 |         2.16865 |
+-------+-------+----------------------------+------------------+-------------------+------------+-----------------+ 
2024-10-02 05:58:16 PM [PID 1] [WARNING] analytics_service.api.AnalyticsService.get_data : The loaded raw metric data for offset 0 days 00:00:00 contain duplicates with respect to device id/timestamp. Duplicates can lead to incorrect results. 
2024-10-02 05:58:16 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService.get_data : get_data_time_seconds=0.288584 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : Executing pipeline with 9 stages. 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : Start timestamps: {Timedelta('0 days 00:00:00'): Timestamp('2024-09-30 00:00:00')}. 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : End timestamps: {Timedelta('0 days 00:00:00'): Timestamp('2024-10-02 17:58:04')}. 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : columns excluded when dropping null rows ['deviceid', '_timestamp', 'logicalinterface_id', 'devicetype', 'format', 'updated_utc', 'evt_timestamp'] 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : columns considered for offset 0 days 00:00:00 when dropping null rows ['temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate', 'entity_id'] 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : temp_set_point count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : input_flow_rate count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : pressure count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : air_flow_rate count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : entity_id count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.util.log_df_info : post drop all null rows for offset 0 days 00:00:00 ; df row count: 10217  ; index: { id , evt_timestamp }  ; columns: { temp_set_point , input_flow_rate , pressure , air_flow_rate , entity_id } 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ RandomDiscreteNumeric }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ RandomDiscreteNumeric }}, execution time = 0.001886 s 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ RandomUniform }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ RandomUniform }}, execution time = 0.002485 s 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ PythonFunction }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.bif.write : def f(df, parameters):
    
    output =df['air_flow_rate'] + ( df['pressure'] - 400. )
    return output 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ PythonFunction }}, execution time = 0.005204 s 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ RandomNoise }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ RandomNoise }}, execution time = 0.001796 s 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ SpectralAnomalyScore }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.execute : Execute SpectralAnomalyScore 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.execute : Execute SpectralAnomalyScore enter per entity execution 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : Timedelta:0 days 00:00:05 Index: DatetimeIndex(['2024-09-30 00:00:00.000194', '2024-09-30 00:05:00.000278',
               '2024-09-30 00:05:00.000302', '2024-09-30 00:05:00.000573',
               '2024-09-30 00:10:00.000204', '2024-09-30 00:10:00.000278',
               '2024-09-30 00:10:00.000573', '2024-09-30 00:15:00.000204',
               '2024-09-30 00:15:00.000213', '2024-09-30 00:15:00.000225',
               ...
               '2024-10-02 17:20:00.000302', '2024-10-02 17:25:00.000213',
               '2024-10-02 17:25:00.000278', '2024-10-02 17:25:00.000302',
               '2024-10-02 17:25:00.000332', '2024-10-02 17:30:00.000213',
               '2024-10-02 17:30:00.000379', '2024-10-02 17:30:00.000573',
               '2024-10-02 17:35:00.000213', '2024-10-02 17:45:00.000302'],
              dtype='datetime64[ns]', name='evt_timestamp', length=2028, freq=None) 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.prepare_data : SpectralAnomalyScore: prepare Data 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : SpectralAnomalyScore, Entity: 73000, Input: temperature, Windowsize: 12, Output: ['A_temp_anomaly'], Overlap: 6, Inputsize: 2028 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : 2028, 12 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.score : Spectral z-score max: 191.63347344360423,   Spectral inv z-score max: 7.367804558988783 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : -> 
HERER 1 A_temp_anomaly 1691 2028 337 Index(['temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate',
       'entity_id', 'entity_data_generator', 'p_leak', 'discharge_perc',
       'demo_output_metric', 'temperature', 'A_temp_anomaly'],
      dtype='object')
HERER 2 [29.54838402 29.0664627  28.58454137 ... 42.42563144 46.89186599
 51.35810055]
2024-10-02 05:58:16 PM [PID 1] [ERROR  ] iotfunctions.anomaly._calc : SpectralAnomalyScore score integration failed with 'NoneType' object has no attribute 'columns' 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : ---> 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : Timedelta:0 days 00:00:05 Index: DatetimeIndex(['2024-09-30 00:00:00.000225', '2024-09-30 00:00:00.000452',
               '2024-09-30 00:00:00.001013', '2024-09-30 00:05:00.000194',
               '2024-09-30 00:05:00.000225', '2024-09-30 00:05:00.001013',
               '2024-09-30 00:10:00.000194', '2024-09-30 00:10:00.000225',
               '2024-09-30 00:10:00.000261', '2024-09-30 00:10:00.000302',
               ...
               '2024-10-02 17:00:00.000213', '2024-10-02 17:00:00.000573',
               '2024-10-02 17:05:00.000225', '2024-10-02 17:10:00.000452',
               '2024-10-02 17:10:00.000573', '2024-10-02 17:15:00.000225',
               '2024-10-02 17:20:00.000225', '2024-10-02 17:35:00.000261',
               '2024-10-02 17:35:00.000302', '2024-10-02 17:40:00.000573'],
              dtype='datetime64[ns]', name='evt_timestamp', length=2041, freq=None) 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.prepare_data : SpectralAnomalyScore: prepare Data 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : SpectralAnomalyScore, Entity: 73001, Input: temperature, Windowsize: 12, Output: ['A_temp_anomaly'], Overlap: 6, Inputsize: 2041 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : 2041, 12 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.score : Spectral z-score max: 175.8145662716437,   Spectral inv z-score max: 6.62431178142637 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : -> 
HERER 1 A_temp_anomaly 1702 2041 339 Index(['temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate',
       'entity_id', 'entity_data_generator', 'p_leak', 'discharge_perc',
       'demo_output_metric', 'temperature', 'A_temp_anomaly'],
      dtype='object')
HERER 2 [28.25046688 26.21780238 24.18513788 ... 28.17868689 27.61924328
 27.05979968]
2024-10-02 05:58:16 PM [PID 1] [ERROR  ] iotfunctions.anomaly._calc : SpectralAnomalyScore score integration failed with 'NoneType' object has no attribute 'columns' 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : ---> 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : Timedelta:0 days 00:00:05 Index: DatetimeIndex(['2024-09-30 00:00:00.000302', '2024-09-30 00:00:00.000332',
               '2024-09-30 00:00:00.000573', '2024-09-30 00:05:00.000332',
               '2024-09-30 00:05:00.000452', '2024-09-30 00:10:00.000302',
               '2024-09-30 00:15:00.001013', '2024-09-30 00:20:00.000194',
               '2024-09-30 00:20:00.000213', '2024-09-30 00:25:00.000573',
               ...
               '2024-10-02 17:15:00.000332', '2024-10-02 17:15:00.000452',
               '2024-10-02 17:20:00.000379', '2024-10-02 17:20:00.000573',
               '2024-10-02 17:25:00.000573', '2024-10-02 17:30:00.000261',
               '2024-10-02 17:35:00.000573', '2024-10-02 17:40:00.000379',
               '2024-10-02 17:50:00.000213', '2024-10-02 17:55:00.000573'],
              dtype='datetime64[ns]', name='evt_timestamp', length=1989, freq=None) 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.prepare_data : SpectralAnomalyScore: prepare Data 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : SpectralAnomalyScore, Entity: 73002, Input: temperature, Windowsize: 12, Output: ['A_temp_anomaly'], Overlap: 6, Inputsize: 1989 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : 1989, 12 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.score : Spectral z-score max: 210.29798606615478,   Spectral inv z-score max: 11.692763486332968 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : -> 
HERER 1 A_temp_anomaly 1659 1989 330 Index(['temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate',
       'entity_id', 'entity_data_generator', 'p_leak', 'discharge_perc',
       'demo_output_metric', 'temperature', 'A_temp_anomaly'],
      dtype='object')
HERER 2 [66.33469596 62.2645001  58.19430424 ...  8.2599251   6.98071101
  5.70149692]
2024-10-02 05:58:16 PM [PID 1] [ERROR  ] iotfunctions.anomaly._calc : SpectralAnomalyScore score integration failed with 'NoneType' object has no attribute 'columns' 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : ---> 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : Timedelta:0 days 00:00:05 Index: DatetimeIndex(['2024-09-30 00:00:00.000261', '2024-09-30 00:00:00.000278',
               '2024-09-30 00:05:00.000261', '2024-09-30 00:10:00.000213',
               '2024-09-30 00:10:00.000379', '2024-09-30 00:15:00.000573',
               '2024-09-30 00:20:00.000261', '2024-09-30 00:25:00.000194',
               '2024-09-30 00:25:00.000332', '2024-09-30 00:25:00.000452',
               ...
               '2024-10-02 17:10:00.000379', '2024-10-02 17:15:00.000213',
               '2024-10-02 17:20:00.000213', '2024-10-02 17:20:00.000278',
               '2024-10-02 17:25:00.000261', '2024-10-02 17:25:00.000379',
               '2024-10-02 17:30:00.000302', '2024-10-02 17:30:00.000332',
               '2024-10-02 17:35:00.000379', '2024-10-02 17:40:00.000302'],
              dtype='datetime64[ns]', name='evt_timestamp', length=2034, freq=None) 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.prepare_data : SpectralAnomalyScore: prepare Data 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : SpectralAnomalyScore, Entity: 73003, Input: temperature, Windowsize: 12, Output: ['A_temp_anomaly'], Overlap: 6, Inputsize: 2034 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : 2034, 12 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.score : Spectral z-score max: 154.08244608563595,   Spectral inv z-score max: 9.252521635667245 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : -> 
HERER 1 A_temp_anomaly 1696 2034 338 Index(['temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate',
       'entity_id', 'entity_data_generator', 'p_leak', 'discharge_perc',
       'demo_output_metric', 'temperature', 'A_temp_anomaly'],
      dtype='object')
HERER 2 [20.44775629 20.67203469 20.89631308 ...  6.51228768  0.28484266
  7.081973  ]
2024-10-02 05:58:16 PM [PID 1] [ERROR  ] iotfunctions.anomaly._calc : SpectralAnomalyScore score integration failed with 'NoneType' object has no attribute 'columns' 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : ---> 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : Timedelta:0 days 00:00:05 Index: DatetimeIndex(['2024-09-30 00:00:00.000204', '2024-09-30 00:00:00.000213',
               '2024-09-30 00:00:00.000302', '2024-09-30 00:00:00.000379',
               '2024-09-30 00:05:00.000204', '2024-09-30 00:05:00.000213',
               '2024-09-30 00:05:00.000302', '2024-09-30 00:05:00.000379',
               '2024-09-30 00:10:00.000452', '2024-09-30 00:10:00.001013',
               ...
               '2024-10-02 17:10:00.000213', '2024-10-02 17:10:00.000225',
               '2024-10-02 17:15:00.000261', '2024-10-02 17:15:00.000573',
               '2024-10-02 17:20:00.000261', '2024-10-02 17:20:00.000332',
               '2024-10-02 17:40:00.000213', '2024-10-02 17:45:00.000213',
               '2024-10-02 17:45:00.000573', '2024-10-02 17:50:00.000573'],
              dtype='datetime64[ns]', name='evt_timestamp', length=2125, freq=None) 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.prepare_data : SpectralAnomalyScore: prepare Data 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : SpectralAnomalyScore, Entity: 73004, Input: temperature, Windowsize: 12, Output: ['A_temp_anomaly'], Overlap: 6, Inputsize: 2125 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : 2125, 12 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.score : Spectral z-score max: 205.37885380617627,   Spectral inv z-score max: 7.474547670891943 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : -> 
HERER 1 A_temp_anomaly 1772 2125 353 Index(['temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate',
       'entity_id', 'entity_data_generator', 'p_leak', 'discharge_perc',
       'demo_output_metric', 'temperature', 'A_temp_anomaly'],
      dtype='object')
HERER 2 [ 4.79656526  1.28791623  2.2207328  ... 45.87212089 48.84296671
 51.81381253]
2024-10-02 05:58:16 PM [PID 1] [ERROR  ] iotfunctions.anomaly._calc : SpectralAnomalyScore score integration failed with 'NoneType' object has no attribute 'columns' 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly._calc : ---> 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.anomaly.execute : Scoring done 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ SpectralAnomalyScore }}, execution time = 0.064731 s 
2024-10-02 05:58:16 PM [PID 1] [WARNING] iotfunctions.pipeline.validate_df : Output dataframe has no columns of type int64. Type has changed or column was dropped. 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ PythonExpression }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ PythonExpression }}, execution time = 0.003223 s 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ PythonExpression }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ PythonExpression }}, execution time = 0.003067 s 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ PersistColumns }} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.execute : columns_to_persist=['p_leak', 'entity_data_generator', 'discharge_perc', 'demo_output_metric', 'temperature', 'A_temp_anomaly', 'discharge_flow_rate', 'output_flow_rate'], df_columns={'temp_set_point': dtype('float64'), 'input_flow_rate': dtype('float64'), 'pressure': dtype('float64'), 'air_flow_rate': dtype('float64'), 'entity_id': dtype('O'), 'entity_data_generator': dtype('bool'), 'p_leak': dtype('float64'), 'discharge_perc': dtype('float64'), 'demo_output_metric': dtype('float64'), 'temperature': dtype('float64'), 'A_temp_anomaly': dtype('float64'), 'discharge_flow_rate': dtype('float64'), 'output_flow_rate': dtype('float64')} 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : table_metrics_to_persist=defaultdict(<class 'dict'>, {'DM_DEVICE_TYPE_Industrial_boiler_912_0L': {'temperature': [False, True, False, False, False], 'demo_output_metric': [False, True, False, False, False], 'discharge_perc': [False, True, False, False, False], 'discharge_flow_rate': [False, True, False, False, False], 'output_flow_rate': [False, True, False, False, False], 'entity_data_generator': [True, False, False, False, False], 'A_temp_anomaly': [False, True, False, False, False], 'p_leak': [False, True, False, False, False]}}) 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : derived_metrics_upsert_sql = MERGE INTO "MAIN18_MAM"."DM_DEVICE_TYPE_INDUSTRIAL_BOILER_912_0L" AS TARGET USING (VALUES (?, ?, ?, ?, ?, ?, ?, CURRENT TIMESTAMP)) AS SOURCE (KEY, "ENTITY_ID", "TIMESTAMP", VALUE_B, VALUE_N, VALUE_S, VALUE_T, LAST_UPDATE) ON TARGET.KEY = SOURCE.KEY AND TARGET."ENTITY_ID" = SOURCE."ENTITY_ID" AND TARGET."TIMESTAMP" = SOURCE."TIMESTAMP" WHEN MATCHED THEN UPDATE SET TARGET.VALUE_B = SOURCE.VALUE_B, TARGET.VALUE_N = SOURCE.VALUE_N, TARGET.VALUE_S = SOURCE.VALUE_S, TARGET.VALUE_T = SOURCE.VALUE_T, TARGET.LAST_UPDATE = SOURCE.LAST_UPDATE WHEN NOT MATCHED THEN INSERT (KEY, "ENTITY_ID", "TIMESTAMP", VALUE_B, VALUE_N, VALUE_S, VALUE_T, LAST_UPDATE) VALUES (SOURCE.KEY, SOURCE."ENTITY_ID", SOURCE."TIMESTAMP", SOURCE.VALUE_B, SOURCE.VALUE_N, SOURCE.VALUE_S, SOURCE.VALUE_T, CURRENT TIMESTAMP) 
2024-10-02 05:58:16 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 5000 
2024-10-02 05:58:17 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 10000 
2024-10-02 05:58:17 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 15000 
2024-10-02 05:58:18 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 20000 
2024-10-02 05:58:19 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 25000 
2024-10-02 05:58:19 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 30000 
2024-10-02 05:58:20 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 35000 
2024-10-02 05:58:20 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 40000 
2024-10-02 05:58:21 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 45000 
2024-10-02 05:58:21 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 50000 
2024-10-02 05:58:22 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 55000 
2024-10-02 05:58:22 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 60000 
2024-10-02 05:58:23 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 65000 
2024-10-02 05:58:23 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 70000 
2024-10-02 05:58:24 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 75000 
2024-10-02 05:58:24 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 80000 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : derived_metrics_persisted = 81736 
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.stages.PersistColumns.execute : persist_data_time_seconds=8.784302 
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.stages.PersistColumns.execute : checkpoint_time_seconds=0.037663 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ PersistColumns }}, execution time = 8.823044 s 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ ProduceAlerts }} 
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.stages.execute : No alerts have been defined for current grain. 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ ProduceAlerts }}, execution time = 0.000276 s 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.db.get_table : Table name = IOT_INDUSTRIAL_BOILER_912_CTG , self.metadata = MetaData(bind=Engine(db2+ibm_db://db2inst1:***@c-mas-montest18-system-db2u-engn-svc.db2u.svc:50001/BLUDB;SECURITY=ssl;SSLServerCertificate=/var/www/as-pipeline/db2_certificate.pem;))   
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.db.query : query statement: SELECT "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".deviceid AS deviceid 
FROM "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG" 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.db.read_sql_query : The following sql statement returned 5 records and was executed in 0.003835 seconds: SELECT "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG".deviceid AS deviceid 
FROM "MAIN18_MAM"."IOT_INDUSTRIAL_BOILER_912_CTG". 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : Returned data frame: = (5, 1) 
Data types of index: {0: dtype('int64')} 
Data types of columns: {'deviceid': dtype('O')} 
+----+------------+
|    |   deviceid |
|----+------------|
|  0 |      73000 |
|  1 |      73001 |
|  2 |      73002 |
|  3 |      73003 |
|  4 |      73004 |
+----+------------+ 
2024-10-02 05:58:25 PM [PID 1] [WARNING] iotfunctions.pipeline.write : Error while writing unmatched members to dimension for offset 0 days 00:00:00. 'deviceid' 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : current_grain=('T', (), True, 3618), dependent_grain=None 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] analytics_service.api.AggregationReloadUpdate.__init__ : aggregation_reload_timestamp=evt_timestamp, aggregation_reload_frequency=T, aggregation_reload_groupby=(), aggregation_reload_entityFirst=True, aggregation_reload_concat_only=False 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : Current data frame for offset 0 days 00:00:00: shape = (10217, 13) 
Data types of index: {'id': dtype('O'), 'evt_timestamp': dtype('<M8[ns]')} 
Data types of columns: {'A_temp_anomaly': dtype('float64'), 'air_flow_rate': dtype('float64'), 'demo_output_metric': dtype('float64'), 'discharge_flow_rate': dtype('float64'), 'discharge_perc': dtype('float64'), 'entity_data_generator': dtype('bool'), 'entity_id': dtype('O'), 'input_flow_rate': dtype('float64'), 'output_flow_rate': dtype('float64'), 'p_leak': dtype('float64'), 'pressure': dtype('float64'), 'temp_set_point': dtype('float64'), 'temperature': dtype('float64')} 
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+
|                                                    |   temp_set_point |   input_flow_rate |   pressure |   air_flow_rate |   entity_id | entity_data_generator   |   p_leak |   discharge_perc |   demo_output_metric |   temperature |   A_temp_anomaly |   discharge_flow_rate |   output_flow_rate |
|----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------|
| ('73000', Timestamp('2024-09-30 00:00:00.000194')) |          200.897 |          10.544   |    400.874 |         2.84293 |       73000 | True                    |    0.001 |         0.163078 |              3.71689 |       201.026 |          29.5484 |               1.71949 |            18.1302 |
| ('73000', Timestamp('2024-09-30 00:05:00.000278')) |          201.946 |          10.5459  |    401.6   |         2.21161 |       73000 | True                    |    0.7   |         0.1997   |              3.81173 |       201.382 |          29.0665 |               2.10601 |            22.2097 |
| ('73000', Timestamp('2024-09-30 00:05:00.000302')) |          199.965 |           9.63343 |    402.127 |         1.66454 |       73000 | True                    |    0.001 |         0.197961 |              3.79153 |       200.677 |          28.5845 |               1.90705 |            18.3714 |
| ('73000', Timestamp('2024-09-30 00:05:00.000573')) |          199.972 |          11.7223  |    400.171 |         2.74505 |       73000 | True                    |    0.001 |         0.100835 |              2.9164  |       201.965 |          28.1026 |               1.18201 |            13.8559 |
| ('73000', Timestamp('2024-09-30 00:10:00.000204')) |          200.769 |           9.88221 |    400.756 |         2.72133 |       73000 | True                    |    0.001 |         0.16792  |              3.47687 |       202.086 |          27.6207 |               1.65942 |            16.3988 |
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+
|                                                    |   temp_set_point |   input_flow_rate |   pressure |   air_flow_rate |   entity_id | entity_data_generator   |   p_leak |   discharge_perc |   demo_output_metric |   temperature |   A_temp_anomaly |   discharge_flow_rate |   output_flow_rate |
|----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------|
| ('73004', Timestamp('2024-10-02 17:20:00.000332')) |          200.526 |           9.38749 |    400.703 |         2.75582 |       73004 | True                    |    0.001 |         0.198267 |              3.45885 |       201.868 |          39.9304 |               1.86122 |           17.4722  |
| ('73004', Timestamp('2024-10-02 17:40:00.000213')) |          201.112 |          11.2731  |    400.729 |         2.8278  |       73004 | True                    |    0.001 |         0.194322 |              3.5569  |       200.724 |          42.9013 |               2.19061 |           24.6949  |
| ('73004', Timestamp('2024-10-02 17:45:00.000213')) |          199.812 |           8.65681 |    402.277 |         2.87294 |       73004 | True                    |    0.001 |         0.123666 |              5.14963 |       200.232 |          45.8721 |               1.07056 |            9.26759 |
| ('73004', Timestamp('2024-10-02 17:45:00.000573')) |          202.513 |          10.3489  |    400.733 |         2.89217 |       73004 | True                    |    0.001 |         0.102992 |              3.62483 |       203.092 |          48.843  |               1.06585 |           11.0303  |
| ('73004', Timestamp('2024-10-02 17:50:00.000573')) |          200.581 |          10.5041  |    401.761 |         2.16865 |       73004 | True                    |    0.001 |         0.185986 |              3.92972 |       200.634 |          51.8138 |               1.95363 |           20.5211  |
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+ 
2024-10-02 05:58:25 PM [PID 1] [INFO   ] analytics_service.api.AggregationReloadUpdate.execute : No cache file handling because backtrack is active. No cached data are loaded from cache file into dataframe. 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.generate_pipeline_stages : all required columns={'output_flow_rate', 'pressure', 'air_flow_rate'}, all generated columns=['air_flow_rate_Industrial_boiler_mean', 'pressure_Industrial_boiler_mean', 'output_flow_rate_Industrial_boiler_mean'], all exchanged columns=[], all required columns of loaders=set(), all generated columns of loaders=[] 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.aggregate.Aggregation.__init__ : aggregation_input_granularity=('T', (), True, 3618) 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.aggregate.Aggregation.__init__ : aggregation_ids=['id'], aggregation_timestamp=evt_timestamp, simple_aggregators=[(<bound method add_simple_aggregator_execute.<locals>.fn of <iotfunctions.aggregate.Mean object at 0x7f2074cf1d20>>, {'air_flow_rate'}, ['air_flow_rate_Industrial_boiler_mean']), (<bound method add_simple_aggregator_execute.<locals>.fn of <iotfunctions.aggregate.Mean object at 0x7f2074cf1e40>>, {'pressure'}, ['pressure_Industrial_boiler_mean']), (<bound method add_simple_aggregator_execute.<locals>.fn of <iotfunctions.aggregate.Mean object at 0x7f2074cf33a0>>, {'output_flow_rate'}, ['output_flow_rate_Industrial_boiler_mean'])], complex_aggregators=[], aggregation_direct_aggregators=[], aggregation_frequency=T, aggregation_groupby=(), aggregation_entityFirst=True, columns_with_scope={} 
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.stages.__init__ : alerts going to database = []  
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.stages.__init__ : alerts going to message hub = []  
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.util.__init__ : EventStreams ca certificate is empty. 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.generate_pipeline_stages : pipeline_stages=['ProjectColumns', 'Aggregation', 'PersistColumns', 'ProduceAlerts'] 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : Executing pipeline with 4 stages. 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : columns excluded when dropping null rows ['deviceid', '_timestamp', 'logicalinterface_id', 'devicetype', 'format', 'updated_utc', 'evt_timestamp'] 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : columns considered for offset 0 days 00:00:00 when dropping null rows ['temp_set_point', 'input_flow_rate', 'pressure', 'air_flow_rate', 'entity_id', 'entity_data_generator', 'p_leak', 'discharge_perc', 'demo_output_metric', 'temperature', 'A_temp_anomaly', 'discharge_flow_rate', 'output_flow_rate'] 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : temp_set_point count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : input_flow_rate count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : pressure count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : air_flow_rate count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : entity_id count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : entity_data_generator count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : p_leak count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : discharge_perc count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : demo_output_metric count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : temperature count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : A_temp_anomaly count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : discharge_flow_rate count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline.execute : output_flow_rate count for offset 0 days 00:00:00 not null: 10217 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.util.log_df_info : post drop all null rows for offset 0 days 00:00:00 ; df row count: 10217  ; index: { id , evt_timestamp }  ; columns: { temp_set_point , input_flow_rate , pressure , air_flow_rate , entity_id , entity_data_generator , p_leak , discharge_perc , demo_output_metric , temperature , A_temp_anomaly , discharge_flow_rate , output_flow_rate } 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ ProjectColumns }} 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] analytics_service.api.ProjectColumns.execute : projected_columns=['pressure', 'air_flow_rate', 'output_flow_rate'], projected_columns_sources=['output_flow_rate', 'pressure', 'evt_timestamp', 'air_flow_rate'] 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ ProjectColumns }}, execution time = 0.00171 s 
2024-10-02 05:58:25 PM [PID 1] [WARNING] iotfunctions.pipeline.validate_df : Output dataframe is missing columns {'temperature', 'demo_output_metric', 'input_flow_rate', 'discharge_perc', 'temp_set_point', 'discharge_flow_rate', 'A_temp_anomaly', 'p_leak'} of type float64. Either the type has changed or column was dropped 
2024-10-02 05:58:25 PM [PID 1] [WARNING] iotfunctions.pipeline.validate_df : Output dataframe has no columns of type object. Type has changed or column was dropped. 
2024-10-02 05:58:25 PM [PID 1] [WARNING] iotfunctions.pipeline.validate_df : Output dataframe has no columns of type bool. Type has changed or column was dropped. 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ Aggregation }} 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.aggregate.Aggregation.execute : group_base=['id', TimeGrouper(level='evt_timestamp', freq=<Minute>, axis=0, sort=True, dropna=True, closed='left', label='left', how='mean', convention='e', origin='start_day', offset=Timedelta('0 days 00:00:00'))], group_base_names=['id', 'evt_timestamp'] 
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.aggregate.Aggregation.execute : A scope has been applied on the following columns: [] 
2024-10-02 05:58:25 PM [PID 1] [DEBUG  ] iotfunctions.aggregate.Aggregation.execute : The following columns are required for simple and complex aggregators: {'output_flow_rate', 'pressure', 'air_flow_rate'} 
2024-10-02 05:58:25 PM [PID 1] [INFO   ] iotfunctions.aggregate.Aggregation.execute : input/output relationship for simple aggregators: ['(input=air_flow_rate --> agg_func=execute_mean() --> output=air_flow_rate_Industrial_boiler_mean)', '(input=pressure --> agg_func=execute_mean() --> output=pressure_Industrial_boiler_mean)', '(input=output_flow_rate --> agg_func=execute_mean() --> output=output_flow_rate_Industrial_boiler_mean)'] 
2024-10-02 05:58:26 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : Data frame after application of simple aggregators = (3716, 3) 
Data types of index: {'id': dtype('O'), 'evt_timestamp': dtype('<M8[ns]')} 
Data types of columns: {'air_flow_rate_Industrial_boiler_mean': dtype('float64'), 'output_flow_rate_Industrial_boiler_mean': dtype('float64'), 'pressure_Industrial_boiler_mean': dtype('float64')} 
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+
|                                                        |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |
|--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------|
| ('73000', Timestamp('2024-09-30 00:00:00', freq='5T')) |                                2.84293 |                           400.874 |                                   18.1302 |
| ('73000', Timestamp('2024-09-30 00:05:00', freq='5T')) |                                2.20707 |                           401.299 |                                   18.1457 |
| ('73000', Timestamp('2024-09-30 00:10:00', freq='5T')) |                                3.10588 |                           400.712 |                                   19.3688 |
| ('73000', Timestamp('2024-09-30 00:15:00', freq='5T')) |                                1.93126 |                           400.15  |                                   16.3103 |
| ('73000', Timestamp('2024-09-30 00:20:00', freq='5T')) |                                3.12889 |                           400.801 |                                   18.9759 |
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+
|                                             |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |
|---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------|
| ('73004', Timestamp('2024-10-02 17:15:00')) |                                1.81274 |                           401.025 |                                   19.6142 |
| ('73004', Timestamp('2024-10-02 17:20:00')) |                                1.70316 |                           401.28  |                                   14.1417 |
| ('73004', Timestamp('2024-10-02 17:40:00')) |                                2.8278  |                           400.729 |                                   24.6949 |
| ('73004', Timestamp('2024-10-02 17:45:00')) |                                2.88255 |                           401.505 |                                   10.149  |
| ('73004', Timestamp('2024-10-02 17:50:00')) |                                2.16865 |                           401.761 |                                   20.5211 |
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+ 
2024-10-02 05:58:26 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : aggregation_final_df = (3716, 3) 
Data types of index: {'id': dtype('O'), 'evt_timestamp': dtype('<M8[ns]')} 
Data types of columns: {'air_flow_rate_Industrial_boiler_mean': dtype('float64'), 'output_flow_rate_Industrial_boiler_mean': dtype('float64'), 'pressure_Industrial_boiler_mean': dtype('float64')} 
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+
|                                                        |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |
|--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------|
| ('73000', Timestamp('2024-09-30 00:00:00', freq='5T')) |                                2.84293 |                           400.874 |                                   18.1302 |
| ('73000', Timestamp('2024-09-30 00:05:00', freq='5T')) |                                2.20707 |                           401.299 |                                   18.1457 |
| ('73000', Timestamp('2024-09-30 00:10:00', freq='5T')) |                                3.10588 |                           400.712 |                                   19.3688 |
| ('73000', Timestamp('2024-09-30 00:15:00', freq='5T')) |                                1.93126 |                           400.15  |                                   16.3103 |
| ('73000', Timestamp('2024-09-30 00:20:00', freq='5T')) |                                3.12889 |                           400.801 |                                   18.9759 |
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+
|                                             |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |
|---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------|
| ('73004', Timestamp('2024-10-02 17:15:00')) |                                1.81274 |                           401.025 |                                   19.6142 |
| ('73004', Timestamp('2024-10-02 17:20:00')) |                                1.70316 |                           401.28  |                                   14.1417 |
| ('73004', Timestamp('2024-10-02 17:40:00')) |                                2.8278  |                           400.729 |                                   24.6949 |
| ('73004', Timestamp('2024-10-02 17:45:00')) |                                2.88255 |                           401.505 |                                   10.149  |
| ('73004', Timestamp('2024-10-02 17:50:00')) |                                2.16865 |                           401.761 |                                   20.5211 |
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+ 
2024-10-02 05:58:26 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ Aggregation }}, execution time = 1.344811 s 
2024-10-02 05:58:26 PM [PID 1] [WARNING] iotfunctions.pipeline.validate_df : Output dataframe is missing columns {'output_flow_rate', 'pressure', 'air_flow_rate'} of type float64. Either the type has changed or column was dropped 
2024-10-02 05:58:26 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ PersistColumns }} 
2024-10-02 05:58:26 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.execute : columns_to_persist=['air_flow_rate_Industrial_boiler_mean', 'pressure_Industrial_boiler_mean', 'output_flow_rate_Industrial_boiler_mean'], df_columns={'air_flow_rate_Industrial_boiler_mean': dtype('float64'), 'pressure_Industrial_boiler_mean': dtype('float64'), 'output_flow_rate_Industrial_boiler_mean': dtype('float64')} 
2024-10-02 05:58:26 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : table_metrics_to_persist=defaultdict(<class 'dict'>, {'DM_DEVICE_TYPE_Industrial_boiler_3618': {'air_flow_rate_Industrial_boiler_mean': [False, True, False, False, False], 'pressure_Industrial_boiler_mean': [False, True, False, False, False], 'output_flow_rate_Industrial_boiler_mean': [False, True, False, False, False]}}) 
2024-10-02 05:58:26 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : derived_metrics_upsert_sql = MERGE INTO "MAIN18_MAM"."DM_DEVICE_TYPE_INDUSTRIAL_BOILER_3618" AS TARGET USING (VALUES (?, ?, ?, ?, ?, ?, ?, CURRENT TIMESTAMP)) AS SOURCE (KEY, "ENTITY_ID", "TIMESTAMP", VALUE_B, VALUE_N, VALUE_S, VALUE_T, LAST_UPDATE) ON TARGET.KEY = SOURCE.KEY AND TARGET."ENTITY_ID" = SOURCE."ENTITY_ID" AND TARGET."TIMESTAMP" = SOURCE."TIMESTAMP" WHEN MATCHED THEN UPDATE SET TARGET.VALUE_B = SOURCE.VALUE_B, TARGET.VALUE_N = SOURCE.VALUE_N, TARGET.VALUE_S = SOURCE.VALUE_S, TARGET.VALUE_T = SOURCE.VALUE_T, TARGET.LAST_UPDATE = SOURCE.LAST_UPDATE WHEN NOT MATCHED THEN INSERT (KEY, "ENTITY_ID", "TIMESTAMP", VALUE_B, VALUE_N, VALUE_S, VALUE_T, LAST_UPDATE) VALUES (SOURCE.KEY, SOURCE."ENTITY_ID", SOURCE."TIMESTAMP", SOURCE.VALUE_B, SOURCE.VALUE_N, SOURCE.VALUE_S, SOURCE.VALUE_T, CURRENT TIMESTAMP) 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 5000 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : Records saved so far = 10000 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] iotfunctions.stages.PersistColumns.store_derived_metrics : derived_metrics_persisted = 11148 
2024-10-02 05:58:27 PM [PID 1] [INFO   ] iotfunctions.stages.PersistColumns.execute : persist_data_time_seconds=1.166218 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ PersistColumns }}, execution time = 1.166852 s 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : Start of stage {{ ProduceAlerts }} 
2024-10-02 05:58:27 PM [PID 1] [INFO   ] iotfunctions.stages.execute : No alerts have been defined for current grain. 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] iotfunctions.pipeline._execute_stage : End of stage {{ ProduceAlerts }}, execution time = 0.000355 s 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : Df for grain ('T', (), True, 3618) and timezone 0 days 00:00:00 after aggregation: shape = (3716, 4) 
Data types of index: {'id': dtype('O'), 'evt_timestamp': dtype('<M8[ns]')} 
Data types of columns: {'air_flow_rate_Industrial_boiler_mean': dtype('float64'), 'entity_id': dtype('O'), 'output_flow_rate_Industrial_boiler_mean': dtype('float64'), 'pressure_Industrial_boiler_mean': dtype('float64')} 
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+
|                                                        |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |   entity_id |
|--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------|
| ('73000', Timestamp('2024-09-30 00:00:00', freq='5T')) |                                2.84293 |                           400.874 |                                   18.1302 |       73000 |
| ('73000', Timestamp('2024-09-30 00:05:00', freq='5T')) |                                2.20707 |                           401.299 |                                   18.1457 |       73000 |
| ('73000', Timestamp('2024-09-30 00:10:00', freq='5T')) |                                3.10588 |                           400.712 |                                   19.3688 |       73000 |
| ('73000', Timestamp('2024-09-30 00:15:00', freq='5T')) |                                1.93126 |                           400.15  |                                   16.3103 |       73000 |
| ('73000', Timestamp('2024-09-30 00:20:00', freq='5T')) |                                3.12889 |                           400.801 |                                   18.9759 |       73000 |
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+
|                                             |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |   entity_id |
|---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------|
| ('73004', Timestamp('2024-10-02 17:15:00')) |                                1.81274 |                           401.025 |                                   19.6142 |       73004 |
| ('73004', Timestamp('2024-10-02 17:20:00')) |                                1.70316 |                           401.28  |                                   14.1417 |       73004 |
| ('73004', Timestamp('2024-10-02 17:40:00')) |                                2.8278  |                           400.729 |                                   24.6949 |       73004 |
| ('73004', Timestamp('2024-10-02 17:45:00')) |                                2.88255 |                           401.505 |                                   10.149  |       73004 |
| ('73004', Timestamp('2024-10-02 17:50:00')) |                                2.16865 |                           401.761 |                                   20.5211 |       73004 |
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+ 
2024-10-02 05:58:27 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : All aggregations for grain ('T', (), True, 3618) have been calculated successfully. 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.upsert_checkpoints : checkpoints_to_upsert = [(Timestamp('2024-10-02 17:45:00.000302'), 912, '73000', 'temp_set_point'), (Timestamp('2024-10-02 17:45:00.000302'), 912, '73000', 'input_flow_rate'), (Timestamp('2024-10-02 17:45:00.000302'), 912, '73000', 'pressure'), (Timestamp('2024-10-02 17:45:00.000302'), 912, '73000', 'air_flow_rate'), (Timestamp('2024-10-02 17:40:00.000573'), 912, '73001', 'temp_set_point'), (Timestamp('2024-10-02 17:40:00.000573'), 912, '73001', 'input_flow_rate'), (Timestamp('2024-10-02 17:40:00.000573'), 912, '73001', 'pressure'), (Timestamp('2024-10-02 17:40:00.000573'), 912, '73001', 'air_flow_rate'), (Timestamp('2024-10-02 17:55:00.000573'), 912, '73002', 'temp_set_point'), (Timestamp('2024-10-02 17:55:00.000573'), 912, '73002', 'input_flow_rate'), (Timestamp('2024-10-02 17:55:00.000573'), 912, '73002', 'pressure'), (Timestamp('2024-10-02 17:55:00.000573'), 912, '73002', 'air_flow_rate'), (Timestamp('2024-10-02 17:40:00.000302'), 912, '73003', 'temp_set_point'), (Timestamp('2024-10-02 17:40:00.000302'), 912, '73003', 'input_flow_rate'), (Timestamp('2024-10-02 17:40:00.000302'), 912, '73003', 'pressure'), (Timestamp('2024-10-02 17:40:00.000302'), 912, '73003', 'air_flow_rate'), (Timestamp('2024-10-02 17:50:00.000573'), 912, '73004', 'temp_set_point'), (Timestamp('2024-10-02 17:50:00.000573'), 912, '73004', 'input_flow_rate'), (Timestamp('2024-10-02 17:50:00.000573'), 912, '73004', 'pressure'), (Timestamp('2024-10-02 17:50:00.000573'), 912, '73004', 'air_flow_rate'), (Timestamp('2024-10-02 17:58:04'), 912, '', '')] 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.upsert_checkpoints : checkpoint_upsert_sql = MERGE INTO "MAIN18_MAM".KPI_CHECKPOINT AS TARGET USING (VALUES (?, ?, ?, ?, CURRENT_TIMESTAMP)) AS SOURCE (TIMESTAMP, ENTITY_TYPE_ID, ENTITY_ID, KEY, LAST_UPDATE) ON TARGET.ENTITY_TYPE_ID = SOURCE.ENTITY_TYPE_ID AND TARGET.ENTITY_ID = SOURCE.ENTITY_ID AND TARGET.KEY = SOURCE.KEY WHEN MATCHED THEN UPDATE SET TARGET.TIMESTAMP = SOURCE.TIMESTAMP, TARGET.LAST_UPDATE = SOURCE.LAST_UPDATE WHEN NOT MATCHED THEN INSERT (TIMESTAMP, ENTITY_TYPE_ID, ENTITY_ID, KEY, LAST_UPDATE) VALUES (SOURCE.TIMESTAMP, SOURCE.ENTITY_TYPE_ID, SOURCE.ENTITY_ID, SOURCE.KEY, CURRENT_TIMESTAMP) 
2024-10-02 05:58:27 PM [PID 1] [DEBUG  ] analytics_service.api.AnalyticsService.upsert_checkpoints : checkpoints_upserted = 21 
2024-10-02 05:58:27 PM [PID 1] [INFO   ] analytics_service.util.api_request : api_request_url=https://rest-v2-core-api.mas-montest18-monitor.svc:9443/api/v2/core/deviceTypes/0891cab6-78b2-46db-9e48-655ac7021e1b/granularity?status=true 
2024-10-02 05:58:27 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService._update_granularitystatus : Success in updating granularity Status... 
2024-10-02 05:58:27 PM [PID 1] [INFO   ] analytics_service.api.AnalyticsService.execute_kpi_pipelines : pipeline total execution time (seconds) = 23.991423 
2024-10-02 05:58:28 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : result_non_aggregated_df for offset 0 days 00:00:00 = (10217, 13) 
Data types of index: {'id': dtype('O'), 'evt_timestamp': dtype('<M8[ns]')} 
Data types of columns: {'A_temp_anomaly': dtype('float64'), 'air_flow_rate': dtype('float64'), 'demo_output_metric': dtype('float64'), 'discharge_flow_rate': dtype('float64'), 'discharge_perc': dtype('float64'), 'entity_data_generator': dtype('bool'), 'entity_id': dtype('O'), 'input_flow_rate': dtype('float64'), 'output_flow_rate': dtype('float64'), 'p_leak': dtype('float64'), 'pressure': dtype('float64'), 'temp_set_point': dtype('float64'), 'temperature': dtype('float64')} 
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+
|                                                    |   temp_set_point |   input_flow_rate |   pressure |   air_flow_rate |   entity_id | entity_data_generator   |   p_leak |   discharge_perc |   demo_output_metric |   temperature |   A_temp_anomaly |   discharge_flow_rate |   output_flow_rate |
|----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------|
| ('73000', Timestamp('2024-09-30 00:00:00.000194')) |          200.897 |          10.544   |    400.874 |         2.84293 |       73000 | True                    |    0.001 |         0.163078 |              3.71689 |       201.026 |          29.5484 |               1.71949 |            18.1302 |
| ('73000', Timestamp('2024-09-30 00:05:00.000278')) |          201.946 |          10.5459  |    401.6   |         2.21161 |       73000 | True                    |    0.7   |         0.1997   |              3.81173 |       201.382 |          29.0665 |               2.10601 |            22.2097 |
| ('73000', Timestamp('2024-09-30 00:05:00.000302')) |          199.965 |           9.63343 |    402.127 |         1.66454 |       73000 | True                    |    0.001 |         0.197961 |              3.79153 |       200.677 |          28.5845 |               1.90705 |            18.3714 |
| ('73000', Timestamp('2024-09-30 00:05:00.000573')) |          199.972 |          11.7223  |    400.171 |         2.74505 |       73000 | True                    |    0.001 |         0.100835 |              2.9164  |       201.965 |          28.1026 |               1.18201 |            13.8559 |
| ('73000', Timestamp('2024-09-30 00:10:00.000204')) |          200.769 |           9.88221 |    400.756 |         2.72133 |       73000 | True                    |    0.001 |         0.16792  |              3.47687 |       202.086 |          27.6207 |               1.65942 |            16.3988 |
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+
|                                                    |   temp_set_point |   input_flow_rate |   pressure |   air_flow_rate |   entity_id | entity_data_generator   |   p_leak |   discharge_perc |   demo_output_metric |   temperature |   A_temp_anomaly |   discharge_flow_rate |   output_flow_rate |
|----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------|
| ('73004', Timestamp('2024-10-02 17:20:00.000332')) |          200.526 |           9.38749 |    400.703 |         2.75582 |       73004 | True                    |    0.001 |         0.198267 |              3.45885 |       201.868 |          39.9304 |               1.86122 |           17.4722  |
| ('73004', Timestamp('2024-10-02 17:40:00.000213')) |          201.112 |          11.2731  |    400.729 |         2.8278  |       73004 | True                    |    0.001 |         0.194322 |              3.5569  |       200.724 |          42.9013 |               2.19061 |           24.6949  |
| ('73004', Timestamp('2024-10-02 17:45:00.000213')) |          199.812 |           8.65681 |    402.277 |         2.87294 |       73004 | True                    |    0.001 |         0.123666 |              5.14963 |       200.232 |          45.8721 |               1.07056 |            9.26759 |
| ('73004', Timestamp('2024-10-02 17:45:00.000573')) |          202.513 |          10.3489  |    400.733 |         2.89217 |       73004 | True                    |    0.001 |         0.102992 |              3.62483 |       203.092 |          48.843  |               1.06585 |           11.0303  |
| ('73004', Timestamp('2024-10-02 17:50:00.000573')) |          200.581 |          10.5041  |    401.761 |         2.16865 |       73004 | True                    |    0.001 |         0.185986 |              3.92972 |       200.634 |          51.8138 |               1.95363 |           20.5211  |
+----------------------------------------------------+------------------+-------------------+------------+-----------------+-------------+-------------------------+----------+------------------+----------------------+---------------+------------------+-----------------------+--------------------+ 
2024-10-02 05:58:28 PM [PID 1] [DEBUG  ] iotfunctions.util.log_data_frame : Granularity = ('T', (), True, 3618), result_aggregated_df for offset 0 days 00:00:00 = (3716, 4) 
Data types of index: {'id': dtype('O'), 'evt_timestamp': dtype('<M8[ns]')} 
Data types of columns: {'air_flow_rate_Industrial_boiler_mean': dtype('float64'), 'entity_id': dtype('O'), 'output_flow_rate_Industrial_boiler_mean': dtype('float64'), 'pressure_Industrial_boiler_mean': dtype('float64')} 
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+
|                                                        |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |   entity_id |
|--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------|
| ('73000', Timestamp('2024-09-30 00:00:00', freq='5T')) |                                2.84293 |                           400.874 |                                   18.1302 |       73000 |
| ('73000', Timestamp('2024-09-30 00:05:00', freq='5T')) |                                2.20707 |                           401.299 |                                   18.1457 |       73000 |
| ('73000', Timestamp('2024-09-30 00:10:00', freq='5T')) |                                3.10588 |                           400.712 |                                   19.3688 |       73000 |
| ('73000', Timestamp('2024-09-30 00:15:00', freq='5T')) |                                1.93126 |                           400.15  |                                   16.3103 |       73000 |
| ('73000', Timestamp('2024-09-30 00:20:00', freq='5T')) |                                3.12889 |                           400.801 |                                   18.9759 |       73000 |
+--------------------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+
|                                             |   air_flow_rate_Industrial_boiler_mean |   pressure_Industrial_boiler_mean |   output_flow_rate_Industrial_boiler_mean |   entity_id |
|---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------|
| ('73004', Timestamp('2024-10-02 17:15:00')) |                                1.81274 |                           401.025 |                                   19.6142 |       73004 |
| ('73004', Timestamp('2024-10-02 17:20:00')) |                                1.70316 |                           401.28  |                                   14.1417 |       73004 |
| ('73004', Timestamp('2024-10-02 17:40:00')) |                                2.8278  |                           400.729 |                                   24.6949 |       73004 |
| ('73004', Timestamp('2024-10-02 17:45:00')) |                                2.88255 |                           401.505 |                                   10.149  |       73004 |
| ('73004', Timestamp('2024-10-02 17:50:00')) |                                2.16865 |                           401.761 |                                   20.5211 |       73004 |
+---------------------------------------------+----------------------------------------+-----------------------------------+-------------------------------------------+-------------+ 
2024-10-02 05:58:28 PM [PID 1] [INFO   ] analytics_service.api.execute_kpi_pipelines : 
#############################################
# Execution of KPI pipeline was successful. #
############################################# 
2024-10-02 05:58:28 PM [PID 1] [DEBUG  ] analytics_service.dblogging._final_update : The log file of 155300 bytes does not exceed the limit of 10485760 bytes. 
2024-10-02 05:58:28 PM [PID 1] [DEBUG  ] analytics_service.dblogging._final_update : Sql statement for final update of log entry in logging table "MAIN18_MAM"."KPI_LOGGING": UPDATE "MAIN18_MAM"."KPI_LOGGING" SET STATUS = ?, LOG_MESSAGE = ?, ERROR_TYPE = ?, ERROR_MESSAGE = ?, ERROR_STACKTRACE = ?, LOGFILE = ?, UPDATED_TS = CURRENT_TIMESTAMP , CURRENT_STAGE_NAME = NULL, CURRENT_STAGE = NULL WHERE TRANSACTION_ID = ?  [SUCCESS, The KPI pipeline has finished successfully., None, None, ..., main.log_###IBM_Temporary###, 870022769286928] 
2024-10-02 05:58:28 PM [PID 1] [INFO   ] analytics_service.main.<module> : Execution was successful. 
2024-10-02 05:58:28 PM [PID 1] [DEBUG  ] iotfunctions.db.release_resource : SQLAlchemy database connection successfully closed. 
2024-10-02 05:58:28 PM [PID 1] [DEBUG  ] iotfunctions.db.release_resource : Native database connection successfully closed. 
